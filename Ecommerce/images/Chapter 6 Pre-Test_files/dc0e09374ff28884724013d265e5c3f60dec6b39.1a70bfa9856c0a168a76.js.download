(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"3XUZ":function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"e",(function(){return c})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return u}));r("jm62"),r("ioFf"),r("RW0V");var o=r("ODXe"),n=r("rePB");r("rGqo"),r("yt8O"),r("Btvt"),r("hhXQ");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e){return"@"===e}function c(e,t){return"".concat(e,"_").concat(t)}function p(e,t,r){var o=t&&t.rows;if(!e)return[];var n=Array.isArray(e)?e:Object.values(e),a=o?n.filter((function(e,o){return!t.rows[o]||t.rows[o]<r.rows})):e;return(t&&t.columns?a.map((function(e){return e?Array.isArray(e)?e.filter((function(e,o){return!t.columns[o]||t.columns[o]<r.columns})):Object.values(e).filter((function(e,o){return!t.columns[o]||t.columns[o]<r.columns})):[]})):a)||[]}function l(e,t){return e&&e.map((function(e){return i({},e,{startX:d("columns",e.startX,t),startY:d("rows",e.startY,t),coords:e.coords.map((function(e){var r=Object(o.a)(e,2),n=r[0],a=r[1];return[d("rows",n,t),d("columns",a,t)]}))})}))||[]}function u(e,t){return e&&e.map((function(e){return i({},e,{row:d("rows",e.row,t),column:d("columns",e.column,t)})}))||[]}function d(e,t,r){return r&&r.offset&&r.offset[e]?parseInt(t)-Object.values(r.offset[e]).filter((function(o,n){return n<parseInt(t)&&o==r.size[e]})).length:t}},Hjrq:function(e,t,r){"use strict";r.d(t,"a",(function(){return Qs}));var o,n,a,i,s,c,p,l,u,d,y,h,b=r("1OyB"),g=r("vuIU"),m=r("md7G"),O=r("foSv"),f=r("Ji7U"),v=r("q1tI"),w=r.n(v),j=(r("jm62"),r("ioFf"),r("rGqo"),r("yt8O"),r("Btvt"),r("RW0V"),r("rePB")),P=r("o0o1"),S=r.n(P),z=(r("ls82"),r("a3ss")),k=r("Y65e"),C=(r("+JCI"),r("2vnA")),D=r("oAJy"),A=r.n(D),x=(o=C.d.bound,n=C.d.bound,a=C.d.bound,i=C.d.bound,s=function(){function e(){Object(b.a)(this,e),Object(z.a)(this,"timerIntervalId",c,this),Object(z.a)(this,"timePassed",p,this),Object(z.a)(this,"startTime",l,this),Object(z.a)(this,"countdown",u,this)}return Object(g.a)(e,[{key:"startCountdown",value:function(e,t){var r=this;this.reset(),this.timerIntervalId&&this.stop(),this.countdown=e,this.startTime=Date.now(),this.timerIntervalId=setInterval((function(){r.timePassed=Date.now()-r.startTime,r.currentCountdownTime<=0&&(r.stop(),t())}),500)}},{key:"start",value:function(e,t){var r=this;this.reset(),this.timerIntervalId&&this.stop(),this.startTime=e?Date.now()-e:Date.now(),this.timerIntervalId=setInterval((function(){r.timePassed=Date.now()-r.startTime,t&&t(r.timePassed)}),500)}},{key:"reset",value:function(){this.timePassed=0,this.startTime=0,this.countdown=0}},{key:"stop",value:function(){clearInterval(this.timerIntervalId),this.timerIntervalId=null}},{key:"hasStarted",get:function(){return!!this.timerIntervalId}},{key:"currentCountdownTime",get:function(){return this.countdown?1e3*this.countdown-this.timePassed:0}}]),e}(),c=Object(k.a)(s.prototype,"timerIntervalId",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),p=Object(k.a)(s.prototype,"timePassed",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),l=Object(k.a)(s.prototype,"startTime",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),u=Object(k.a)(s.prototype,"countdown",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Object(k.a)(s.prototype,"hasStarted",[C.f],Object.getOwnPropertyDescriptor(s.prototype,"hasStarted"),s.prototype),Object(k.a)(s.prototype,"currentCountdownTime",[C.f],Object.getOwnPropertyDescriptor(s.prototype,"currentCountdownTime"),s.prototype),Object(k.a)(s.prototype,"startCountdown",[o],Object.getOwnPropertyDescriptor(s.prototype,"startCountdown"),s.prototype),Object(k.a)(s.prototype,"start",[n],Object.getOwnPropertyDescriptor(s.prototype,"start"),s.prototype),Object(k.a)(s.prototype,"reset",[a],Object.getOwnPropertyDescriptor(s.prototype,"reset"),s.prototype),Object(k.a)(s.prototype,"stop",[i],Object.getOwnPropertyDescriptor(s.prototype,"stop"),s.prototype),s);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var G,M,N,_,F,E,V,L,R,U,q,W,K,Q,B,H,Z,X,Y=(d=C.d.bound,y=C.d.bound,h=function(){function e(t,r){Object(b.a)(this,e),this.main=t,this.player=r,this.timer=new x,this.hasExistingStats=!1}return Object(g.a)(e,[{key:"addPuzzlePlayed",value:function(e){var t;return S.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,S.a.awrap(this.main.db.getNode({type:"accounts",uid:e,attr:"forwardStatsTo"}));case 2:t=r.sent,this.main.db.admin.incrementStats(e),t&&this.main.db.admin.incrementStats(t);case 5:case"end":return r.stop()}}),null,this)}},{key:"startTimer",value:function(){var e,t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.a.awrap(this.player.getPlayerCredentials());case 2:return e=n.sent,t=e.uid,r=e.puzzleKey,n.next=7,S.a.awrap(this.main.db.account.getPuzzleTimePassed(t,r));case 7:o=n.sent,this.timer.start(o);case 9:case"end":return n.stop()}}),null,this)}},{key:"connectPlayerToPuzzle",value:function(){var e,t,r;return S.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return this.hasExistingStats=!0,o.next=3,S.a.awrap(this.player.getPlayerCredentials());case 3:return e=o.sent,t=e.uid,r=e.puzzleKey,o.next=8,S.a.awrap(this.main.db.account.connectPlayerToPuzzle(t,r));case 8:case"end":return o.stop()}}),null,this)}},{key:"save",value:function(e){var t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.hasExistingStats){n.next=3;break}return n.next=3,S.a.awrap(this.connectPlayerToPuzzle());case 3:return n.next=5,S.a.awrap(this.player.getPlayerCredentials());case 5:return t=n.sent,r=t.uid,o=t.puzzleKey,n.next=10,S.a.awrap(this.main.db.account.savePuzzleStats(r,o,T({timePassed:this.timer.timePassed,lastPlayedAt:Date.now()},e)));case 10:case"end":return n.stop()}}),null,this)}}]),e}(),Object(k.a)(h.prototype,"addPuzzlePlayed",[d],Object.getOwnPropertyDescriptor(h.prototype,"addPuzzlePlayed"),h.prototype),Object(k.a)(h.prototype,"startTimer",[y],Object.getOwnPropertyDescriptor(h.prototype,"startTimer"),h.prototype),h);function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ee,te,re,oe,ne,ae,ie,se,ce,pe,le,ue=(G=C.d.bound,M=C.d.bound,N=C.d.bound,_=C.d.bound,F=C.d.bound,E=C.d.bound,V=C.d.bound,L=C.d.bound,R=C.d.bound,U=C.d.bound,q=C.d.bound,W=function(){function e(t,r,o){Object(b.a)(this,e),Object(z.a)(this,"isLoading",K,this),Object(z.a)(this,"showPlayer",Q,this),Object(z.a)(this,"isEmbedded",B,this),Object(z.a)(this,"isReadOnly",H,this),Object(z.a)(this,"stats",Z,this),Object(z.a)(this,"countdown",X,this),this.main=t,this.isEmbedded=!!r,this.isReadOnly=!!o,this.stats=new Y(this.main,this),this.countdown=new x,this.SAVED_PUZZLE_PREFIX="puzzle_",this.hasAddedPuzzlePlayed=!1}return Object(g.a)(e,[{key:"checkHasAddedPuzzlePlayed",value:function(){var e,t;return S.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e=this.main.puzzleKey,t="".concat(this.SAVED_PUZZLE_PREFIX,"_saved_").concat(e),r.next=5,S.a.awrap(A.a.getItem(t));case 5:this.hasAddedPuzzlePlayed=r.sent;case 6:case"end":return r.stop()}}),null,this)}},{key:"setHasAddedPuzzlePlayed",value:function(){var e,t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.hasAddedPuzzlePlayed){n.next=2;break}return n.abrupt("return");case 2:return n.prev=2,n.next=5,S.a.awrap(this.checkHasAddedPuzzlePlayed());case 5:if(!this.hasAddedPuzzlePlayed){n.next=7;break}return n.abrupt("return");case 7:return this.hasAddedPuzzlePlayed=!0,e=this.main.puzzleKey,t="".concat(this.SAVED_PUZZLE_PREFIX,"_saved_").concat(e),n.prev=10,n.next=13,S.a.awrap(A.a.setItem(t,!0));case 13:return n.next=15,S.a.awrap(this.getPuzzleCredentials());case 15:r=n.sent,o=r.uid,this.stats.addPuzzlePlayed(o),n.next=23;break;case 20:n.prev=20,n.t0=n.catch(10),console.log("saving locally too early");case 23:n.next=28;break;case 25:n.prev=25,n.t1=n.catch(2),console.log("saving locally too early");case 28:case"end":return n.stop()}}),null,this,[[2,25],[10,20]])}},{key:"setIsLoading",value:function(e){this.isLoading=e}},{key:"setShowPlayer",value:function(e){this.showPlayer=e}},{key:"getPlayerCredentials",value:function(){var e,t,r;return S.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.main.puzzleKey,o.next=3,S.a.awrap(this.main.getUser());case 3:return t=o.sent,r=this.main.params&&this.main.params.uid?this.main.params.uid:t.uid,o.abrupt("return",{puzzleKey:e,uid:r});case 6:case"end":return o.stop()}}),null,this)}},{key:"getPuzzleCredentials",value:function(){var e,t;return S.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e=this.main.puzzleKey,r.next=3,S.a.awrap(this.main.db.getIndex(e));case 3:return t=r.sent,r.abrupt("return",{puzzleKey:e,uid:t});case 5:case"end":return r.stop()}}),null,this)}},{key:"autoSavePuzzle",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this.main,n=o.isPremium,a=o.puzzleKey,i=$({},e,{version:t||Date.now()}),s=Object(C.q)(i);n&&r?this.stats.save(s):this.savePuzzleLocally(a,s)}},{key:"clearLocalPuzzle",value:function(){var e=this.main.puzzleKey,t="".concat(this.SAVED_PUZZLE_PREFIX).concat(e);A.a.removeItem(t)}},{key:"resetSavedPuzzle",value:function(){A.a.setItem("".concat(this.SAVED_PUZZLE_PREFIX).concat(this.puzzleKey),null),this.main.store.isRegistered&&this.stats.save(null)}},{key:"getSavedPuzzle",value:function(e){var t="".concat(this.SAVED_PUZZLE_PREFIX).concat(e);return A.a.getItem(t)}},{key:"savePuzzleLocally",value:function(e,t){var r="".concat(this.SAVED_PUZZLE_PREFIX).concat(e);A.a.setItem(r,t)}}]),e}(),K=Object(k.a)(W.prototype,"isLoading",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Q=Object(k.a)(W.prototype,"showPlayer",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),B=Object(k.a)(W.prototype,"isEmbedded",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),H=Object(k.a)(W.prototype,"isReadOnly",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Z=Object(k.a)(W.prototype,"stats",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=Object(k.a)(W.prototype,"countdown",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Object(k.a)(W.prototype,"checkHasAddedPuzzlePlayed",[G],Object.getOwnPropertyDescriptor(W.prototype,"checkHasAddedPuzzlePlayed"),W.prototype),Object(k.a)(W.prototype,"setHasAddedPuzzlePlayed",[M],Object.getOwnPropertyDescriptor(W.prototype,"setHasAddedPuzzlePlayed"),W.prototype),Object(k.a)(W.prototype,"setIsLoading",[N],Object.getOwnPropertyDescriptor(W.prototype,"setIsLoading"),W.prototype),Object(k.a)(W.prototype,"setShowPlayer",[_],Object.getOwnPropertyDescriptor(W.prototype,"setShowPlayer"),W.prototype),Object(k.a)(W.prototype,"getPlayerCredentials",[F],Object.getOwnPropertyDescriptor(W.prototype,"getPlayerCredentials"),W.prototype),Object(k.a)(W.prototype,"getPuzzleCredentials",[E],Object.getOwnPropertyDescriptor(W.prototype,"getPuzzleCredentials"),W.prototype),Object(k.a)(W.prototype,"autoSavePuzzle",[V],Object.getOwnPropertyDescriptor(W.prototype,"autoSavePuzzle"),W.prototype),Object(k.a)(W.prototype,"clearLocalPuzzle",[L],Object.getOwnPropertyDescriptor(W.prototype,"clearLocalPuzzle"),W.prototype),Object(k.a)(W.prototype,"resetSavedPuzzle",[R],Object.getOwnPropertyDescriptor(W.prototype,"resetSavedPuzzle"),W.prototype),Object(k.a)(W.prototype,"getSavedPuzzle",[U],Object.getOwnPropertyDescriptor(W.prototype,"getSavedPuzzle"),W.prototype),Object(k.a)(W.prototype,"savePuzzleLocally",[q],Object.getOwnPropertyDescriptor(W.prototype,"savePuzzleLocally"),W.prototype),W),de=r("ZZSv"),ye=r.n(de),he=r("i3v8"),be=r("SPse"),ge=r("28M9"),me=(ee=C.m.shallow,te=C.d.bound,re=C.d.bound,oe=C.d.bound,ne=C.d.bound,ae=C.d.bound,ie=function(){function e(t,r,o){Object(b.a)(this,e),Object(z.a)(this,"settings",se,this),Object(z.a)(this,"premiumBlocks",ce,this),Object(z.a)(this,"isLoading",pe,this),this.player=t.player,this.multiplayer=t.multiplayer,this.gaming=t.gaming,this.settings=r,this.premiumBlocks=o,this.loadFromDb()}return Object(g.a)(e,[{key:"loadFromDb",value:function(){var e,t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.a.awrap(this.player.getPuzzleCredentials());case 2:return e=n.sent,t=e.puzzleKey,r=e.uid,n.next=7,S.a.awrap(this.player.main.db.getNode({type:"puzzles",puzzleKey:t,uid:r}));case 7:o=n.sent,this.setSettingsFromDb(o);case 9:case"end":return n.stop()}}),null,this)}},{key:"setSettingsFromDb",value:function(e){e?(this.settings=this.settings.map((function(t){return Object(he.c)(t,e)})),this.setPremiumSettingsFromDb(e),this.isLoading=!1,this.player.setIsLoading(!1)):Object(be.b)("404",this.player.main.language)}},{key:"setPremiumSettingsFromDb",value:function(e){this.premiumBlocks=this.premiumBlocks.map((function(t){return Object(he.b)(t,e)})),this.checkForRegistration()}},{key:"checkForRegistration",value:function(){var e=this.getSettingValue("puzzleType"),t="slidingpuzzle"===e?"slidingPuzzle":e,r=this.getPremiumValue(t,"isForcingRegistration"),o=this.getPremiumValue(t,"playInTeams"),n=this.getPremiumValue(t,"forceMultiplayer");r||o||n?o?this.multiplayer.loadSession():n&&this.gaming.loadActiveGameSession():this.player.setShowPlayer(!0)}},{key:"getSettingValue",value:function(e,t){var r=t||this.settings,o=ye()(r,(function(t){return t.id==e}));return o?o.value:null}},{key:"getPremiumValue",value:function(e,t,r){var o=r||this.premiumBlocks,n=ye()(o,(function(t){return t.id==e}));if(!n)return!1;var a=ye()(n.settings,(function(e){return e.id==t}));return a?a.value:null}},{key:"getCustomStyling",value:function(e,t){var r=this.getPremiumValue("customStyling",e,t);return"fontFamily"==e?Object(ge.a)(r):r}}]),e}(),se=Object(k.a)(ie.prototype,"settings",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=Object(k.a)(ie.prototype,"premiumBlocks",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),pe=Object(k.a)(ie.prototype,"isLoading",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Object(k.a)(ie.prototype,"setPremiumSettingsFromDb",[te],Object.getOwnPropertyDescriptor(ie.prototype,"setPremiumSettingsFromDb"),ie.prototype),Object(k.a)(ie.prototype,"checkForRegistration",[re],Object.getOwnPropertyDescriptor(ie.prototype,"checkForRegistration"),ie.prototype),Object(k.a)(ie.prototype,"getSettingValue",[oe],Object.getOwnPropertyDescriptor(ie.prototype,"getSettingValue"),ie.prototype),Object(k.a)(ie.prototype,"getPremiumValue",[ne],Object.getOwnPropertyDescriptor(ie.prototype,"getPremiumValue"),ie.prototype),Object(k.a)(ie.prototype,"getCustomStyling",[ae],Object.getOwnPropertyDescriptor(ie.prototype,"getCustomStyling"),ie.prototype),ie),Oe=r("l/Iq"),fe=r("CIue"),ve=r("kMSe"),we=r("vPnW"),je=(r("KKXr"),r("SRfc"),r("84bF"),r("JX7q")),Pe=r("MX0m"),Se=r.n(Pe),ze=r("v4dT"),ke=r("WUHI"),Ce=r("hfyT"),De=r("olgr"),Ae=r("zvQJ"),xe=r("Gg0s"),Ie=w.a.createElement,Te=Object(ve.b)("store","puzzle","setting")(le=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(m.a)(this,Object(O.a)(t).call(this,e))).state={isClosed:!1},r.close=r.close.bind(Object(je.a)(r)),r}return Object(f.a)(t,e),Object(g.a)(t,[{key:"close",value:function(){this.setState({isClosed:!0})}},{key:"getCorrectPercentage",value:function(e){if(!e)return null;if("wordseeker"!=this.props.setting.getSettingValue("puzzleType"))return null;if(!this.props.setting.getPremiumValue("wordseeker","useCountdownTimer"))return null;var t=this.props.puzzle,r=t.correctAnswersGiven,o=t.wordsPlaced;return r.length/o.length*100|0}},{key:"render",value:function(){var e=this.props,t=e.setting,r=e.puzzle,o=t.getPremiumValue,n=r.showCompletedOnCountdown,a=r.stats,i=o("completedMessage","showCompletedMessage"),s=o("completedMessage","showConfetti"),c=o("completedMessage","collectUserInfo"),p=o("completedMessage","header"),l=o("completedMessage","body"),u=o("completedMessage","image_path"),d=o("completedMessage","body_image_path"),y=o("completedMessage","cta"),h=o("completedMessage","ctaText"),b=this.getCorrectPercentage(c),g=this.state.isClosed;if(!i||g)return null;var m=this.props.store,O=m.translations,f=m.styling,v=this.props.setting,w=v.premiumBlocks,j=v.getCustomStyling,P=p||O.premium.completed_message_header_placeholder,S=l||O.premium.completed_message_body_placeholder,z=y&&h?h:y,k=s&&Ie(ke.a,{position:"absolute"}),C=j("firstColor",w)||f.colors.secondary,D=j("secondColor",w)||f.colors.tertiary,A=j("fontFamily",w)||f.fonts.secondary;return Ie(ze.a,{closeModal:this.close,uncloseable:n},Ie("div",{className:Se.a.dynamic([["2197343630",[C,D,f.fonts.primary,C,f.media.small]],["3099974500",[C,D,A]]])+" CompletedMessageModal with-black-scrollbar"},Ie("div",{className:Se.a.dynamic([["2197343630",[C,D,f.fonts.primary,C,f.media.small]],["3099974500",[C,D,A]]])+" header"},u&&Ie("img",{src:Object(xe.a)(u),className:Se.a.dynamic([["2197343630",[C,D,f.fonts.primary,C,f.media.small]],["3099974500",[C,D,A]]])}),P.match(/\w/)&&Ie("h2",{className:Se.a.dynamic([["2197343630",[C,D,f.fonts.primary,C,f.media.small]],["3099974500",[C,D,A]]])},P.split(" ").map((function(e,t){return Ie("span",{key:t,className:Se.a.dynamic([["2197343630",[C,D,f.fonts.primary,C,f.media.small]],["3099974500",[C,D,A]]])},e)})))),k,Ie("div",{className:Se.a.dynamic([["2197343630",[C,D,f.fonts.primary,C,f.media.small]],["3099974500",[C,D,A]]])+" body"},Ie(Ce.a,{text:S}),d&&Ie("img",{src:Object(xe.a)(d),className:Se.a.dynamic([["2197343630",[C,D,f.fonts.primary,C,f.media.small]],["3099974500",[C,D,A]]])}),c&&Ie(De.a,{correctPercentage:b,stats:a||{}}),Ie("div",{className:Se.a.dynamic([["2197343630",[C,D,f.fonts.primary,C,f.media.small]],["3099974500",[C,D,A]]])+" new-challenge"},Ie(Ae.g,{isBig:!0,url:"https://www2.primepractice.com.au/adx-2020-word-search-challenge",icon:"start",label:"new_challenge"})),y&&Ie("a",{href:y,target:"_blank",rel:"noopener noreferrer",className:Se.a.dynamic([["2197343630",[C,D,f.fonts.primary,C,f.media.small]],["3099974500",[C,D,A]]])},z)),Ie(Se.a,{id:"2197343630",dynamic:[C,D,f.fonts.primary,C,f.media.small]},[".header.__jsx-style-dynamic-selector{height:200px;position:relative;}",".new-challenge.__jsx-style-dynamic-selector{display:none;}",".header.__jsx-style-dynamic-selector h2.__jsx-style-dynamic-selector{position:absolute;top:50%;left:20px;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);white-space:normal;}",".header.__jsx-style-dynamic-selector h2.__jsx-style-dynamic-selector span.__jsx-style-dynamic-selector{background-color:".concat(C,";color:white;padding:5px 10px;margin:5px;display:inline-block;}"),".header.__jsx-style-dynamic-selector img.__jsx-style-dynamic-selector{object-fit:cover;position:absolute;top:0;left:0;width:100%;height:100%;}",".body.__jsx-style-dynamic-selector{position:relative;z-index:1;}",".body.__jsx-style-dynamic-selector img.__jsx-style-dynamic-selector{max-width:100%;}",".close.__jsx-style-dynamic-selector{position:absolute;top:0;right:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:40px;height:40px;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:".concat(D,";z-index:20;cursor:pointer;}"),".close.__jsx-style-dynamic-selector span.__jsx-style-dynamic-selector{font-size:32px;color:white;display:block;font-family:".concat(f.fonts.primary,";}"),"h2.__jsx-style-dynamic-selector{font-size:40px;max-width:100%;margin:0;}","a.__jsx-style-dynamic-selector{font-size:20px;position:relative;z-index:1;color:".concat(C,";}"),".image-wrapper.__jsx-style-dynamic-selector{max-width:100%;max-height:80%;margin:10px 0;}",".image-wrapper.__jsx-style-dynamic-selector img.__jsx-style-dynamic-selector{max-width:100%;max-height:100%;}","@media ".concat(f.media.small,"{h2.__jsx-style-dynamic-selector{font-size:28px;}}")]),Ie(Se.a,{id:"3099974500",dynamic:[C,D,A]},[".CompletedMessageModal .LeadGenerationForm input{border-radius:0 !important;}",".CompletedMessageModal .LeadGenerationForm .form-row{margin:10px 0;}",".CompletedMessageModal .Highlight{background-color:".concat(C,";border-left-color:").concat(D,";font-family:").concat(A,";border-radius:0;}")])))}}]),t}(w.a.Component))||le,Ge=r("6ldB"),Me=r.n(Ge),Ne=w.a.createElement;function _e(e){return e.show?Ne("div",{className:"jsx-3613921706 PlayerAd"},Ne(Me.a.Google,{client:"ca-pub-8835136508126240",slot:"9854999216",style:{display:"block"},responsive:"true",format:"auto"}),Ne(Se.a,{id:"3613921706"},[".PlayerAd.jsx-3613921706{margin:20px 0;}","@media print{.PlayerAd.jsx-3613921706{display:none;}}"])):null}var Fe,Ee,Ve,Le=r("6UbP"),Re=r("W80W"),Ue=r("5qf+"),qe=r("zufX"),We=w.a.createElement,Ke=Object(ve.b)("store")(Fe=function(e){function t(){return Object(b.a)(this,t),Object(m.a)(this,Object(O.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){if(!this.props.show)return null;var e=this.props.store,t=e.language,r=e.puzzleKey,o=Object(Le.b)("".concat(t,"/").concat(this.props.puzzleType,"/play?p=").concat(r));return We(ze.a,{header:"share_puzzle",closeModal:this.props.closeModal},We("div",{className:"jsx-2102250351 copy"},We("input",{type:"text",readOnly:!0,value:o,className:"jsx-2102250351"}),We(Re.a,{text:o,active:!0}),We("div",{className:"jsx-2102250351 social"},We(Ue.a,{url:o}),We(qe.a,{url:o}))),We(Se.a,{id:"3501837323"},[".copy.jsx-2102250351{margin:20px 0;}","input.jsx-2102250351{display:inline-block;vertical-align:middle;width:calc(100% - 50px);padding-left:0;}",".social.jsx-2102250351{margin-top:5px;}"]),We(Se.a,{id:"474578733"},[".social .InlineIcon{margin-right:5px;}"]))}}]),t}(w.a.Component))||Fe,Qe=w.a.createElement,Be=Object(ve.b)("store")(Ee=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(m.a)(this,Object(O.a)(t).call(this,e))).state={showModal:!1},r.closeModal=r.closeModal.bind(Object(je.a)(r)),r.openModal=r.openModal.bind(Object(je.a)(r)),r}return Object(f.a)(t,e),Object(g.a)(t,[{key:"closeModal",value:function(){this.setState({showModal:!1})}},{key:"openModal",value:function(){this.setState({showModal:!0})}},{key:"render",value:function(){return Qe(w.a.Fragment,null,Qe(Ae.b,{icon:"share",handleClick:this.openModal,label:"share_puzzle"}),Qe(Ke,{puzzleType:this.props.puzzleType,closeModal:this.closeModal,show:this.state.showModal}))}}]),t}(w.a.Component))||Ee,He=r("mlqF"),Ze=w.a.createElement,Xe=Object(ve.b)("store","player")(Ve=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(m.a)(this,Object(O.a)(t).call(this,e))).handleClick=r.handleClick.bind(Object(je.a)(r)),r}return Object(f.a)(t,e),Object(g.a)(t,[{key:"handleClick",value:function(){var e=this,t=document.querySelector(".grid"),r=document.querySelector(".grid-wrapper");t.style.display="block",t.style.height="auto",r.style.display="block",Object(He.c)(t,(function(){return e.props.player.setIsLoading(!1)})),t.style.display="",r.style.display="",t.style.height=""}},{key:"render",value:function(){var e=this.props.store,t=e.premium,r=e.premiumUser,o=this.props.premiumNotRequired,n=t||r||o;return this.props.show?Ze(Ae.f,{icon:"media",handleClick:n?this.handleClick:void 0,label:"save_as_image",disabled:!n}):null}}]),t}(w.a.Component))||Ve,Ye=w.a.createElement;function Je(){return Ye(Ae.b,{label:"print_puzzle",icon:"print",handleClick:function(){return window.print()}})}var $e,et=w.a.createElement,tt=Object(ve.b)("puzzle")((function(e){var t=e.puzzle;return et("div",{className:"jsx-747569709 RevealAnswersAction"},et(Ae.b,{icon:"show",label:"reveal_puzzle",handleClick:t.toggleRevealAnswers}),et(Se.a,{id:"747569709"},[".RevealAnswersAction.jsx-747569709{display:none;vertical-align:top;}"]))})),rt=w.a.createElement,ot=Object(ve.b)("store","player","setting","puzzle")($e=Object(ve.c)($e=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(m.a)(this,Object(O.a)(t).call(this,e))).handleReset=r.handleReset.bind(Object(je.a)(r)),r.handleLogout=r.handleLogout.bind(Object(je.a)(r)),r}return Object(f.a)(t,e),Object(g.a)(t,[{key:"handleReset",value:function(){this.props.puzzle.reset()}},{key:"handleLogout",value:function(){this.props.puzzle.reset&&this.props.puzzle.reset(),this.props.store.signout(!0),this.props.store.setRegistered(!1),this.props.player.setShowPlayer(!1)}},{key:"render",value:function(){var e=this.props.store,t=e.translations,r=e.premium,o=e.isRegistered,n=this.props.player.isEmbedded,a=this.props,i=a.position,s=a.isLTI,c=this.props.setting,p=c.premiumBlocks,l=c.getPremiumValue,u=c.settings,d=c.getSettingValue;if(!p.length)return null;if(this.props.setting.getPremiumValue("default","actionPanelPosition",this.props.setting.premiumBlocks)!=i)return null;var y=l("default","showEmbeddedActionPanel",p),h=this.props.setting.getPremiumValue("default","puzzleDescription",this.props.setting.premiumBlocks),b=this.props.setting.getCustomStyling("headerFontFamily",this.props.setting.premiumBlocks),g=this.props.setting.getCustomStyling("dangerColor",this.props.setting.premiumBlocks);if(n&&!y&&!s)return null;var m=d("name",u),O=d("puzzleType"),f="wordseeker"==O&&l(O,"allowRegeneratePuzzle",p);return rt("div",{className:Se.a.dynamic([["2049060932",[b,g]],["129070959",[n?"100%":"90%",b]]])+" ActionPanel"},rt("div",{className:Se.a.dynamic([["2049060932",[b,g]],["129070959",[n?"100%":"90%",b]]])+" wrapper"},rt("h1",{className:Se.a.dynamic([["2049060932",[b,g]],["129070959",[n?"100%":"90%",b]]])},m||t.puzzle_no_name),rt("div",{className:Se.a.dynamic([["2049060932",[b,g]],["129070959",[n?"100%":"90%",b]]])+" actions"},h&&rt("p",{style:{margin:"10px auto 20px",maxWidth:"80%"},className:Se.a.dynamic([["2049060932",[b,g]],["129070959",[n?"100%":"90%",b]]])},h),("crossword"==O||"wordseeker"==O)&&rt(Je,null),"crossword"==O&&rt(tt,null),this.props.puzzle.reset&&rt(Ae.c,{label:"reset_puzzle",handleClick:this.handleReset}),!n&&rt(Be,{puzzleType:O}),rt(Xe,{show:"crossword"==O||"wordseeker"==O||"acrostic"==O||"word-scramble"==O,puzzleType:O,premiumNotRequired:n||s}),f&&rt(Ae.c,{icon:"icon-rebuild",label:"regenerate_puzzle",handleClick:this.props.puzzle.regenerate}),o&&rt(Ae.b,{icon:"logout",label:"logout",handleClick:this.handleLogout})),rt(_e,{show:!1===r})),rt(Se.a,{id:"2049060932",dynamic:[b,g]},[".ActionPanel .Button button{width:275px;}",".ActionPanel .Button button span{font-family:".concat(b,";}"),".ActionPanel .Button{display:inline-block;margin:0 10px 10px 0 !important;}",".ActionPanel .Button.danger button{background-color:".concat(g,";}")]),rt(Se.a,{id:"129070959",dynamic:[n?"100%":"90%",b]},[".ActionPanel.__jsx-style-dynamic-selector{margin:20px auto;text-align:center;}",".wrapper.__jsx-style-dynamic-selector{background-color:white;box-shadow:4px 4px 20px 2px rgba(0,0,0,0.5);display:inline-block;max-width:".concat(n?"100%":"90%",";}"),"h1.__jsx-style-dynamic-selector{font-size:24px;background-color:black;color:white;padding:10px 20px;font-family:".concat(b,";}"),".actions.__jsx-style-dynamic-selector{padding:10px;}"]))}}]),t}(w.a.Component))||$e)||$e,nt=r("TSYQ"),at=r.n(nt),it=r("+CFO"),st=w.a.createElement,ct=Object(ve.b)("store")((function(e){var t=e.item,r=e.isActive,o=e.setActiveItem,n=e.store;return st("span",{onClick:function(){return o(t)},className:Se.a.dynamic([["1523478254",[n.styling.colors.tertiary,n.styling.media.small]]])+" "+(at()("NavItem",{active:r})||"")},st(it.a,{label:t}),st(Se.a,{id:"1523478254",dynamic:[n.styling.colors.tertiary,n.styling.media.small]},[".NavItem.__jsx-style-dynamic-selector{background-color:black;color:white;display:inline-block;padding:20px;border:1px solid #f0f0f0;cursor:pointer;}",".NavItem.__jsx-style-dynamic-selector:hover{background-color:".concat(n.styling.colors.tertiary,";}"),"@media ".concat(n.styling.media.small,"{.NavItem.__jsx-style-dynamic-selector{padding:5px;font-size:16px;}}")]))})),pt=w.a.createElement;function lt(e){var t=e.items,r=e.activeItem,o=e.setActiveItem;return pt("div",{className:"jsx-3586290223 NavItems"},t.map((function(e){return pt(ct,{key:e,setActiveItem:o,isActive:e===r,item:e})})),pt(Se.a,{id:"3586290223"},[".NavItems.jsx-3586290223{margin-bottom:20px;}"]))}r("VRzm"),r("XfO3");var ut,dt=r("WJCh"),yt=r("Nhx4"),ht=r("vOkV"),bt=w.a.createElement;function gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function mt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ot,ft,vt,wt=Object(ve.b)("store")(ut=Object(ve.c)(ut=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(m.a)(this,Object(O.a)(t).call(this,e))).formStore=new dt.a(yt.b,r.handleSubmit.bind(Object(je.a)(r))),r}return Object(f.a)(t,e),Object(g.a)(t,[{key:"handleSubmit",value:function(e){var t,r,o,n,a,i,s,c,p;return S.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return t=this.props.store,r=t.puzzleKey,o=t.language,n=e.email,a=e.password,l.next=4,S.a.awrap(this.props.store.db.account.linkCredentialToCurrentUser({email:n,password:a}));case 4:if(!(i=l.sent).code){l.next=9;break}this.formStore.setError(i),l.next=18;break;case 9:return s=this.props.store.db.account.create(mt({},e,{language:o}),i.uid),c=this.props.store.db.account.savePuzzleStats(i.uid,r,{registered:!0}),p=this.props.store.db.account.connectPlayerToPuzzle(i.uid,r),l.next=14,S.a.awrap(Promise.all([s,c,p]));case 14:return l.next=16,S.a.awrap(this.props.store.db.account.signIn({email:n,password:a}));case 16:this.formStore.setIsDone(!0),this.props.onSubmit();case 18:case"end":return l.stop()}}),null,this)}},{key:"render",value:function(){return bt(ht.a,{header:"register",form:this.formStore,bgColor:"#dddddd"})}}]),t}(w.a.Component))||ut)||ut,jt=r("vyQL"),Pt=w.a.createElement,St=Object(ve.b)("store")(Ot=Object(ve.c)(Ot=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(m.a)(this,Object(O.a)(t).call(this,e))).formStore=new dt.a(jt.a,r.handleSubmit.bind(Object(je.a)(r))),r}return Object(f.a)(t,e),Object(g.a)(t,[{key:"handleSubmit",value:function(e){var t,r,o,n,a,i;return S.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.email,r=e.password,o=this.props.store.puzzleKey,s.next=4,S.a.awrap(this.props.store.db.account.signIn({email:t,password:r}));case 4:if(!(n=s.sent).code){s.next=9;break}this.formStore.setError(n),s.next=14;break;case 9:return a=this.props.store.db.account.initPuzzleStats(n.uid,o,{registered:!0}),i=this.props.store.db.account.connectPlayerToPuzzle(n.uid,o),s.next=13,S.a.awrap(Promise.all([a,i]));case 13:this.props.onSubmit();case 14:case"end":return s.stop()}}),null,this)}},{key:"render",value:function(){return Pt(ht.a,{header:"login",form:this.formStore,bgColor:"#dddddd"})}}]),t}(w.a.Component))||Ot)||Ot,zt=r("PFrS"),kt=w.a.createElement,Ct=Object(ve.b)("store","player","setting")(ft=Object(ve.c)(ft=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(m.a)(this,Object(O.a)(t).call(this,e))).state={activeItem:"register"},r.setActiveItem=r.setActiveItem.bind(Object(je.a)(r)),r.handleSuccessfulRegistration=r.handleSuccessfulRegistration.bind(Object(je.a)(r)),r}return Object(f.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.checkForExistingRegistration()}},{key:"checkForExistingRegistration",value:function(){var e,t,r,o,n,a;return S.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=this.props.store,i.next=3,S.a.awrap(e.getUser());case 3:if(!(t=i.sent).isAnonymous){i.next=6;break}return i.abrupt("return");case 6:return i.next=8,S.a.awrap(e.db.account.getPuzzleRegistration(t.uid,e.puzzleKey));case 8:r=i.sent,o=this.props.setting.getSettingValue("puzzleType"),n="slidingpuzzle"===o?"slidingPuzzle":o,a=this.props.setting.getPremiumValue(n,"isForcingRegistration"),r&&a&&this.handleSuccessfulRegistration();case 13:case"end":return i.stop()}}),null,this)}},{key:"setActiveItem",value:function(e){this.setState({activeItem:e})}},{key:"handleSuccessfulRegistration",value:function(){return S.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.awrap(this.props.store.setUser());case 2:this.props.store.setRegistered(!0),this.props.player.setShowPlayer(!0),this.props.player.stats.startTimer();case 5:case"end":return e.stop()}}),null,this)}},{key:"render",value:function(){if(this.props.store.isRegistered)return null;if(this.props.setting.isLoading)return null;var e=this.props.setting.getSettingValue("puzzleType"),t="slidingpuzzle"===e?"slidingPuzzle":e;if(!this.props.setting.getPremiumValue(t,"isForcingRegistration"))return null;var r=this.props.setting.getPremiumValue(t,"registrationIntro"),o=this.props.setting.getCustomStyling("headerFontFamily"),n=this.state.activeItem;return kt(ze.a,{headerFont:o,header:"get_access_to_puzzle",closeModal:this.props.closeModal,uncloseable:!0},kt(lt,{items:["register","login","reset_password"],activeItem:n,setActiveItem:this.setActiveItem}),r&&kt("p",{style:{fontSize:"18px"},className:Se.a.dynamic([["2857353266",[o,o,o]]])+" margin-20"},r),"register"===n&&kt(wt,{onSubmit:this.handleSuccessfulRegistration}),"login"===n&&kt(St,{onSubmit:this.handleSuccessfulRegistration}),"reset_password"===n&&kt(zt.a,null),kt(Se.a,{id:"2857353266",dynamic:[o,o,o]},[".Modal .Form .Setting label{font-family:".concat(o,";}"),".Modal .Form h2{font-family:".concat(o,";}"),".Modal .Form .Button button span{font-family:".concat(o,";}")]))}}]),t}(w.a.Component))||ft)||ft,Dt=r("wx14"),At=(r("f3/d"),r("D2ij")),xt=[At.u,At.L],It=r("qsZd"),Tt=w.a.createElement;function Gt(e){var t=e.name,r=e.teamName,o=e.teamPlayers;return Tt("div",{className:"RegistrationDone"},Tt("h3",null,Tt(it.a,{label:"welcome"})," ",t,","),Tt("p",{className:"highlight"},Tt(it.a,{label:"registration_in_team"})," ",r),Tt(It.b,{label:"wait_for_start"}),Tt("h2",null,Tt(it.a,{label:"team_members"})),Tt("ul",null,o.map((function(e){return Tt("li",{key:e.uid},e.name)}))))}var Mt,Nt,_t,Ft,Et,Vt,Lt,Rt,Ut,qt,Wt,Kt,Qt,Bt,Ht,Zt,Xt,Yt,Jt,$t,er,tr,rr,or,nr,ar,ir=w.a.createElement,sr=Object(ve.b)("multiplayer","setting")(vt=Object(ve.c)(vt=function(e){function t(e){var r;return Object(b.a)(this,t),(r=Object(m.a)(this,Object(O.a)(t).call(this,e))).getTeamName=function(e){return ye()(r.props.multiplayer.session.teamNames,(function(t){return t.id==e})).name},r.formStore=new dt.a(xt,r.handleSubmit.bind(Object(je.a)(r))),r}return Object(f.a)(t,e),Object(g.a)(t,[{key:"handleSubmit",value:function(e){return S.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.a.awrap(this.props.multiplayer.createRegistration(e));case 2:this.props.multiplayer.registration&&this.formStore.setIsDone(!0);case 4:case"end":return t.stop()}}),null,this)}},{key:"render",value:function(){if(this.props.setting.isLoading)return null;var e=this.props.setting.getSettingValue("puzzleType");if(!this.props.setting.getPremiumValue(e,"playInTeams"))return null;var t=this.props.multiplayer,r=t.status,o=t.registration,n=t.teamPlayers;if("play"===r&&o)return null;var a=this.props.setting.getCustomStyling("headerFontFamily");return"play"!==r||o?ir(ze.a,{headerFont:a,header:"multiplayer_registration",uncloseable:!0},"registration"===r&&!o&&ir(ht.a,{form:this.formStore,submitLabel:"join_puzzle",bgColor:"#dddddd"}),"registration"===r&&o&&ir(Gt,Object(Dt.a)({},o,{teamName:this.getTeamName(o.team),teamPlayers:n})),"closed"===r&&ir(It.b,{label:"no_active_session"}),ir(we.a,{isLoading:"loading"===r}),ir(Se.a,{id:"2609237671",dynamic:[a,a,a]},[".Modal .Form .Setting label{font-family:".concat(a,";}"),".Modal .Form h2,.Modal h3,.Modal h2{font-family:".concat(a,";}"),".Modal .Form .Button button span{font-family:".concat(a,";}")])):ir(ze.a,{headerFont:a,header:"multiplayer_registration",uncloseable:!0},ir(It.b,{label:"multiplayer_already_started"}))}}]),t}(w.a.Component))||vt)||vt,cr=r("KQm4"),pr=r("s7pt");function lr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function ur(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lr(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var dr=(Mt=C.d.bound,Nt=C.d.bound,_t=C.d.bound,Ft=C.d.bound,Et=C.d.bound,Vt=C.d.bound,Lt=C.d.bound,Rt=C.d.bound,Ut=C.d.bound,qt=C.d.bound,Wt=C.d.bound,Kt=C.d.bound,Qt=C.d.bound,Bt=C.d.bound,Ht=C.d.bound,Zt=C.d.bound,Xt=C.d.bound,Yt=C.d.bound,Jt=C.d.bound,$t=function(){function e(t){Object(b.a)(this,e),Object(z.a)(this,"session",er,this),Object(z.a)(this,"sessionId",tr,this),Object(z.a)(this,"status",rr,this),Object(z.a)(this,"teamSessionId",or,this),Object(z.a)(this,"registration",nr,this),Object(z.a)(this,"players",ar,this),this.player=t,this.puzzleStore=null,this.credentials=null}return Object(g.a)(e,[{key:"loadSession",value:function(){var e,t,r,o,n,a;return S.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return this.player.setIsLoading(!0),i.next=3,S.a.awrap(this.player.getPuzzleCredentials());case 3:return this.credentials=i.sent,e=this.credentials,t=e.uid,r=e.puzzleKey,this.checkForActiveRegistration(),i.next=8,S.a.awrap(this.player.main.db.multiplayer.getActiveSession(t,r));case 8:if(o=i.sent,n=o.sessionId,a=o.session){i.next=13;break}return i.abrupt("return",this.handleNoSession());case 13:this.loadActiveSession(n,a);case 14:case"end":return i.stop()}}),null,this)}},{key:"handleNoSession",value:function(){this.setStatus("closed"),this.setNewActiveSessionListener()}},{key:"checkForActiveRegistration",value:function(){var e,t,r,o,n;return S.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,S.a.awrap(this.player.main.getUser());case 2:return e=a.sent,a.next=5,S.a.awrap(this.player.main.db.multiplayer.getActiveRegistrationsByUid(e.uid));case 5:return t=a.sent,r=this.credentials.puzzleKey,a.next=9,S.a.awrap(this.getActiveSessionId());case 9:o=a.sent,n=Object(pr.c)({puzzleKey:r,sessionId:o},t),this.setRegistration(n);case 12:case"end":return a.stop()}}),null,this)}},{key:"getActiveSessionId",value:function(){var e=this.credentials.puzzleKey;return this.player.main.db.multiplayer.getPuzzleActiveSessionId(e)}},{key:"handleNewActiveSession",value:function(e){var t,r;return S.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.val(),o.next=3,S.a.awrap(this.getActiveSessionId());case 3:r=o.sent,this.loadActiveSession(r,t);case 5:case"end":return o.stop()}}),null,this)}},{key:"loadActiveSession",value:function(e,t){var r,o,n;return S.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return this.setSessionId(e),this.setSession(t),r=ur({},this.credentials,{sessionId:e}),o=this.player.main.db.multiplayer.listenForSessionStatusChanges(r,this.handleStatusChange),n=this.player.main.db.multiplayer.setNewRegistrationListener(e,this.addNewPlayers),a.next=7,S.a.awrap(Promise.all([o,n]));case 7:case"end":return a.stop()}}),null,this)}},{key:"addNewPlayers",value:function(e){var t=e.val(),r=Object(cr.a)(this.players);r.push(t),this.players=r}},{key:"handleStatusChange",value:function(e){var t=e.val();this.setStatus(t)}},{key:"setNewActiveSessionListener",value:function(){var e=this.credentials,t=e.uid,r=e.puzzleKey;this.player.main.db.multiplayer.waitForActiveSessionListener(t,r,this.handleNewActiveSession)}},{key:"createRegistration",value:function(e){var t,r,o,n,a;return S.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t=this.credentials.puzzleKey,i.next=3,S.a.awrap(this.player.main.getUser());case 3:return r=i.sent,i.next=6,S.a.awrap(this.player.main.db.multiplayer.getPuzzleActiveSessionId(t));case 6:return o=i.sent,n=this.getRegistrationWithTeam(e),a={uid:r.uid,puzzleKey:t,sessionId:o},i.next=11,S.a.awrap(this.player.main.db.multiplayer.createRegistration(a,n));case 11:this.setRegistration(ur({},n,{},a));case 12:case"end":return i.stop()}}),null,this)}},{key:"getRegistrationWithTeam",value:function(e){return this.session.randomizeTeams?ur({},e,{team:this.getRandomTeam()}):e}},{key:"getRandomTeam",value:function(){if(!this.teams.length)return Math.ceil(Math.random()*this.session.numTeams);var e=this.teams.reduce((function(e,t){return e>t.players.length?t.players.length:e}),999),t=this.teams.filter((function(t){return t.players.length==e}));return t[Math.random()*t.length|0].id}},{key:"setRegistration",value:function(e){this.registration=e,e&&!this.session&&this.checkForSessionMatchingRegistrationSession(),e&&this.subscribeToTeamSession()}},{key:"checkForSessionMatchingRegistrationSession",value:function(){var e,t,r,o,n,a;return S.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=this.credentials,t=e.uid,r=e.puzzleKey,i.next=3,S.a.awrap(this.player.main.db.multiplayer.getActiveSession(t,r));case 3:if(o=i.sent,n=o.sessionId,a=o.session){i.next=8;break}return i.abrupt("return",this.handleNoSession());case 8:this.loadActiveSession(n,a);case 9:case"end":return i.stop()}}),null,this)}},{key:"setStatus",value:function(e){"play"===e?this.player.setShowPlayer(!0):"closed"==e&&"closed"!==this.status&&(this.player.setShowPlayer(!1),this.setRegistration(null),this.player.main.db.multiplayer.stopNewRegistrationListener(),this.setNewActiveSessionListener(),this.players=[]),this.status=e}},{key:"subscribeToTeamSession",value:function(){if(this.session&&this.registration){var e=this.registration.team;this.teamSessionId=ye()(this.session.teamSessions,(function(t){return t.teamNumber==e})).sessionId,this.player.main.db.multiplayer.subscribeToTeamSession(this.teamSessionId,this.handleTeamInput)}}},{key:"updateTeamSession",value:function(e){this.player.main.db.multiplayer.updateTeamSession(this.teamSessionId,e)}},{key:"handleTeamInput",value:function(e){this.puzzleStore.updateWithTeamSessionInput(e)}},{key:"setSessionId",value:function(e){this.sessionId=e}},{key:"setSession",value:function(e){this.session=e,e&&this.setStatus(e.status)}},{key:"setPuzzleStore",value:function(e){this.puzzleStore=e}},{key:"teamPlayers",get:function(){var e=this;return this.registration?this.players.filter((function(t){return t.team===e.registration.team&&t.uid!=e.registration.uid})):[]}},{key:"teams",get:function(){var e=this;return this.session&&this.session.teamSessions?this.session.teamSessions.reduce((function(t,r){var o=r.teamNumber,n=e.players.filter((function(e){return e.team==o}));return t.push({id:o,players:n}),t}),[]):[]}}]),e}(),er=Object(k.a)($t.prototype,"session",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tr=Object(k.a)($t.prototype,"sessionId",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rr=Object(k.a)($t.prototype,"status",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"loading"}}),or=Object(k.a)($t.prototype,"teamSessionId",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nr=Object(k.a)($t.prototype,"registration",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ar=Object(k.a)($t.prototype,"players",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(k.a)($t.prototype,"teamPlayers",[C.f],Object.getOwnPropertyDescriptor($t.prototype,"teamPlayers"),$t.prototype),Object(k.a)($t.prototype,"teams",[C.f],Object.getOwnPropertyDescriptor($t.prototype,"teams"),$t.prototype),Object(k.a)($t.prototype,"loadSession",[Mt],Object.getOwnPropertyDescriptor($t.prototype,"loadSession"),$t.prototype),Object(k.a)($t.prototype,"handleNoSession",[Nt],Object.getOwnPropertyDescriptor($t.prototype,"handleNoSession"),$t.prototype),Object(k.a)($t.prototype,"checkForActiveRegistration",[_t],Object.getOwnPropertyDescriptor($t.prototype,"checkForActiveRegistration"),$t.prototype),Object(k.a)($t.prototype,"handleNewActiveSession",[Ft],Object.getOwnPropertyDescriptor($t.prototype,"handleNewActiveSession"),$t.prototype),Object(k.a)($t.prototype,"loadActiveSession",[Et],Object.getOwnPropertyDescriptor($t.prototype,"loadActiveSession"),$t.prototype),Object(k.a)($t.prototype,"addNewPlayers",[Vt],Object.getOwnPropertyDescriptor($t.prototype,"addNewPlayers"),$t.prototype),Object(k.a)($t.prototype,"handleStatusChange",[Lt],Object.getOwnPropertyDescriptor($t.prototype,"handleStatusChange"),$t.prototype),Object(k.a)($t.prototype,"setNewActiveSessionListener",[Rt],Object.getOwnPropertyDescriptor($t.prototype,"setNewActiveSessionListener"),$t.prototype),Object(k.a)($t.prototype,"createRegistration",[Ut],Object.getOwnPropertyDescriptor($t.prototype,"createRegistration"),$t.prototype),Object(k.a)($t.prototype,"getRegistrationWithTeam",[qt],Object.getOwnPropertyDescriptor($t.prototype,"getRegistrationWithTeam"),$t.prototype),Object(k.a)($t.prototype,"getRandomTeam",[Wt],Object.getOwnPropertyDescriptor($t.prototype,"getRandomTeam"),$t.prototype),Object(k.a)($t.prototype,"setRegistration",[Kt],Object.getOwnPropertyDescriptor($t.prototype,"setRegistration"),$t.prototype),Object(k.a)($t.prototype,"setStatus",[Qt],Object.getOwnPropertyDescriptor($t.prototype,"setStatus"),$t.prototype),Object(k.a)($t.prototype,"subscribeToTeamSession",[Bt],Object.getOwnPropertyDescriptor($t.prototype,"subscribeToTeamSession"),$t.prototype),Object(k.a)($t.prototype,"updateTeamSession",[Ht],Object.getOwnPropertyDescriptor($t.prototype,"updateTeamSession"),$t.prototype),Object(k.a)($t.prototype,"handleTeamInput",[Zt],Object.getOwnPropertyDescriptor($t.prototype,"handleTeamInput"),$t.prototype),Object(k.a)($t.prototype,"setSessionId",[Xt],Object.getOwnPropertyDescriptor($t.prototype,"setSessionId"),$t.prototype),Object(k.a)($t.prototype,"setSession",[Yt],Object.getOwnPropertyDescriptor($t.prototype,"setSession"),$t.prototype),Object(k.a)($t.prototype,"setPuzzleStore",[Jt],Object.getOwnPropertyDescriptor($t.prototype,"setPuzzleStore"),$t.prototype),$t),yr=(r("Vd3H"),r("ODXe"));var hr,br,gr,mr,Or,fr,vr,wr,jr,Pr,Sr,zr,kr,Cr,Dr,Ar,xr,Ir,Tr=r("4L12");function Gr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}var Mr,Nr,_r,Fr,Er,Vr,Lr,Rr,Ur,qr,Wr,Kr,Qr,Br,Hr,Zr,Xr,Yr,Jr,$r,eo,to,ro,oo,no,ao,io,so,co,po,lo,uo,yo,ho,bo,go,mo,Oo=(hr=C.m.shallow,br=C.m.shallow,gr=C.m.shallow,mr=C.d.bound,Or=C.d.bound,fr=C.d.bound,vr=C.d.bound,wr=C.d.bound,jr=C.d.bound,Pr=C.d.bound,Sr=function(){function e(t,r,o){Object(b.a)(this,e),Object(z.a)(this,"grid",zr,this),Object(z.a)(this,"questions",kr,this),Object(z.a)(this,"wordsPlaced",Cr,this),Object(z.a)(this,"correctAnswersGiven",Dr,this),Object(z.a)(this,"direction",Ar,this),Object(z.a)(this,"currentAnswer",xr,this),Object(z.a)(this,"showCompletedOnCountdown",Ir,this),this.playerStore=t,this.settingStore=r,this.multiplayer=o,this.handleCheckAnswer=this.handleCheckAnswer.bind(this),this.loadFromDb()}return Object(g.a)(e,[{key:"checkProgress",value:function(){this.checkAnswer=Object(C.e)(this.handleCheckAnswer)}},{key:"loadFromDb",value:function(){var e,t,r,o,n,a,i,s,c;return S.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,S.a.awrap(this.playerStore.getPuzzleCredentials());case 2:return e=p.sent,t=e.uid,r=e.puzzleKey,o=this.playerStore.main.db.getNode({type:"fields",uid:t,puzzleKey:r}),n=this.playerStore.main.db.getNode({type:"questions",uid:t,puzzleKey:r}),p.next=9,S.a.awrap(Promise.all([o,n]));case 9:if(a=p.sent,i=Object(yr.a)(a,2),s=i[0],c=i[1],s){p.next=15;break}return p.abrupt("return");case 15:this.setGrid(s.grid||s.gridArray),this.setQuestions(c),this.setWordsPlaced(s.wordsPlaced);case 18:case"end":return p.stop()}}),null,this)}},{key:"loadSavedPuzzle",value:function(){if(!this.settingStore.getPremiumValue("wordseeker","allowRegeneratePuzzle")){var e=this.settingStore.getSettingValue("version"),t=this.settingStore.getPremiumValue("wordseeker","playInTeams"),r=this.settingStore.getPremiumValue("wordseeker","isTrackingStats"),o=this.settingStore.getPremiumValue("wordseeker","reloadGivenAnswers");if(!t&&o)this.playerStore.main.isPremium&&r?this.loadSavedPuzzleFromStats(e):this.loadLocalPuzzle(e)}}},{key:"loadSavedPuzzleFromStats",value:function(e){var t,r,o,n;return S.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,S.a.awrap(this.playerStore.getPlayerCredentials());case 2:return t=a.sent,r=t.puzzleKey,o=t.uid,a.next=7,S.a.awrap(this.playerStore.main.db.account.getSavedPuzzle(o,r));case 7:(n=a.sent)&&e==n.version&&this.loadSavedAnswers(n);case 9:case"end":return a.stop()}}),null,this)}},{key:"loadLocalPuzzle",value:function(e){var t,r;return S.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.playerStore.main.puzzleKey,o.next=3,S.a.awrap(this.playerStore.getSavedPuzzle(t));case 3:((r=o.sent)&&r.version==e||!e)&&this.loadSavedAnswers(r);case 5:case"end":return o.stop()}}),null,this)}},{key:"loadSavedAnswers",value:function(e){if(e){var t=e.answers;t&&t.length&&this.setCorrectAnswersGiven(t)}}},{key:"answerIsNotFilledInYet",value:function(e){return this.correctAnswersGiven.every((function(t){return t.word!=e}))}},{key:"handleCheckAnswer",value:function(){if(this.currentAnswer.total){var e=this.currentAnswer.total.reduce((function(e,t){return e+t.char.toLowerCase()}),"");ye()(this.wordsPlaced,(function(t){return t.word.toLowerCase()==e}))&&this.answerIsNotFilledInYet(e)&&this.addAnswer({cells:this.currentAnswer.total,word:e.toLowerCase()}),this.resetFocus(),this.playerStore.setHasAddedPuzzlePlayed()}}},{key:"addAnswer",value:function(e){var t=Object(cr.a)(this.correctAnswersGiven);t.push(e),this.correctAnswersGiven=t,this.savePuzzle(t),"play"===this.multiplayer.status&&this.multiplayer.updateTeamSession({answers:Object(C.q)(t)})}},{key:"savePuzzle",value:function(e){var t=this.settingStore.getSettingValue("version"),r=this.settingStore.getPremiumValue("wordseeker","isTrackingStats");this.playerStore.autoSavePuzzle({answers:Object(C.q)(e)},t,r)}},{key:"updateWithTeamSessionInput",value:function(e){var t=e.answers,r=this.mergeAnswersWithNewAnswers(t);this.setCorrectAnswersGiven(r)}},{key:"mergeAnswersWithNewAnswers",value:function(e){return e?e.reduce((function(e,t){return e.some((function(e){return e.word==t.word}))?e:[].concat(Object(cr.a)(e),[t])}),Object(cr.a)(this.correctAnswersGiven)):this.correctAnswersGiven}},{key:"saveClick",value:function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Gr(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.currentAnswer);t.end&&(t.start=null,t.end=null,t.total=null),t.start?(t.end=e,t.total=function(e){for(var t=e.start,r=e.end,o=e.grid,n=[],a=t.row==r.row?"column":"row",i=t.row==r.row?"row":"column",s={">=":function(e,t){return e>=t},"<=":function(e,t){return e<=t}},c=t[a]<r[a]?"<=":">=",p=t[i],l=t[a];s[c](l,r[a]);l="<="==c?l+1:l-1){var u="row"==a?o[l][p]:o[p][l];n.push({row:"row"==a?l:p,column:"row"==a?p:l,char:u}),t[i]!=r[i]&&(p=t[i]<r[i]?p+1:p-1)}return n}({start:t.start,end:t.end,grid:this.grid})):t.start=e,this.currentAnswer=t}},{key:"setDirection",value:function(e){this.direction=e}},{key:"setCorrectAnswersGiven",value:function(e){this.correctAnswersGiven=e}},{key:"setGrid",value:function(e){this.grid=e}},{key:"setQuestions",value:function(e){this.questions=e}},{key:"setWordsPlaced",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.wordsPlaced=e.sort((function(e,t){return e.word<t.word?-1:e.word>t.word?1:0}))}},{key:"resetFocus",value:function(){this.direction=null,this.currentAnswer=[]}},{key:"reset",value:function(){this.resetFocus(),this.correctAnswersGiven=[],this.savePuzzle([]),this.resetCountdownTimer()}},{key:"regenerate",value:function(){this.resetFocus(),this.correctAnswersGiven=[];var e=this.settingStore.getSettingValue("size"),t=this.settingStore.getSettingValue("directions"),r=new Tr.a({size:e,directions:t,words:this.questions});r.fillGrid();var o=r.convertGridToArray(),n=r.getWordsPlaced();this.setGrid(o),this.setWordsPlaced(n),this.resetCountdownTimer()}},{key:"resetCountdownTimer",value:function(){if(this.settingStore.getPremiumValue("wordseeker","useCountdownTimer")){var e=this.settingStore.getPremiumValue("wordseeker","timerInSeconds"),t=this.settingStore.getPremiumValue("wordseeker","showCompletedAfterCountdown");this.playerStore.stats.timer.stop(),this.playerStore.countdown.stop(),this.playerStore.countdown.startCountdown(e,this.setShowCompletedOnCountdown.bind(null,t))}}},{key:"onWindowClose",value:function(){this.playerStore.stats.timer.stop(),this.playerStore.countdown.stop(),window.removeEventListener("beforeunload",this.onWindowClose)}},{key:"setShowCompletedOnCountdown",value:function(e){(this.showCompletedOnCountdown=e,this.playerStore.stats.timer.stop(),this.playerStore.countdown.stop(),e||this.isCompleted)||(this.settingStore.getPremiumValue("wordseeker","allowRegeneratePuzzle")?this.regenerate():this.reset())}},{key:"isCompleted",get:function(){return!(!this.correctAnswersGiven||!this.wordsPlaced||this.isLoading)&&(this.correctAnswersGiven.length===this.wordsPlaced.length||this.showCompletedOnCountdown)}}]),e}(),zr=Object(k.a)(Sr.prototype,"grid",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),kr=Object(k.a)(Sr.prototype,"questions",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Cr=Object(k.a)(Sr.prototype,"wordsPlaced",[hr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Dr=Object(k.a)(Sr.prototype,"correctAnswersGiven",[br],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ar=Object(k.a)(Sr.prototype,"direction",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xr=Object(k.a)(Sr.prototype,"currentAnswer",[gr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Ir=Object(k.a)(Sr.prototype,"showCompletedOnCountdown",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(k.a)(Sr.prototype,"checkProgress",[mr],Object.getOwnPropertyDescriptor(Sr.prototype,"checkProgress"),Sr.prototype),Object(k.a)(Sr.prototype,"isCompleted",[C.f],Object.getOwnPropertyDescriptor(Sr.prototype,"isCompleted"),Sr.prototype),Object(k.a)(Sr.prototype,"addAnswer",[C.d],Object.getOwnPropertyDescriptor(Sr.prototype,"addAnswer"),Sr.prototype),Object(k.a)(Sr.prototype,"savePuzzle",[Or],Object.getOwnPropertyDescriptor(Sr.prototype,"savePuzzle"),Sr.prototype),Object(k.a)(Sr.prototype,"updateWithTeamSessionInput",[fr],Object.getOwnPropertyDescriptor(Sr.prototype,"updateWithTeamSessionInput"),Sr.prototype),Object(k.a)(Sr.prototype,"saveClick",[C.d],Object.getOwnPropertyDescriptor(Sr.prototype,"saveClick"),Sr.prototype),Object(k.a)(Sr.prototype,"setDirection",[C.d],Object.getOwnPropertyDescriptor(Sr.prototype,"setDirection"),Sr.prototype),Object(k.a)(Sr.prototype,"setCorrectAnswersGiven",[C.d],Object.getOwnPropertyDescriptor(Sr.prototype,"setCorrectAnswersGiven"),Sr.prototype),Object(k.a)(Sr.prototype,"setGrid",[C.d],Object.getOwnPropertyDescriptor(Sr.prototype,"setGrid"),Sr.prototype),Object(k.a)(Sr.prototype,"setQuestions",[C.d],Object.getOwnPropertyDescriptor(Sr.prototype,"setQuestions"),Sr.prototype),Object(k.a)(Sr.prototype,"setWordsPlaced",[C.d],Object.getOwnPropertyDescriptor(Sr.prototype,"setWordsPlaced"),Sr.prototype),Object(k.a)(Sr.prototype,"resetFocus",[C.d],Object.getOwnPropertyDescriptor(Sr.prototype,"resetFocus"),Sr.prototype),Object(k.a)(Sr.prototype,"reset",[vr],Object.getOwnPropertyDescriptor(Sr.prototype,"reset"),Sr.prototype),Object(k.a)(Sr.prototype,"regenerate",[wr],Object.getOwnPropertyDescriptor(Sr.prototype,"regenerate"),Sr.prototype),Object(k.a)(Sr.prototype,"onWindowClose",[jr],Object.getOwnPropertyDescriptor(Sr.prototype,"onWindowClose"),Sr.prototype),Object(k.a)(Sr.prototype,"setShowCompletedOnCountdown",[Pr],Object.getOwnPropertyDescriptor(Sr.prototype,"setShowCompletedOnCountdown"),Sr.prototype),Sr),fo=r("obyI"),vo=(Mr=C.d.bound,Nr=C.d.bound,_r=C.d.bound,Fr=C.d.bound,Er=C.d.bound,Vr=C.d.bound,Lr=C.d.bound,Rr=function(){function e(t,r){Object(b.a)(this,e),Object(z.a)(this,"questions",Ur,this),Object(z.a)(this,"phase",qr,this),Object(z.a)(this,"currentQuestionIdx",Wr,this),Object(z.a)(this,"answers",Kr,this),Object(z.a)(this,"isCheckable",Qr,this),this.playerStore=t,this.settingStore=r,this.timer=new x,this.loadQuiz()}return Object(g.a)(e,[{key:"loadQuiz",value:function(){var e,t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.a.awrap(this.playerStore.getPuzzleCredentials());case 2:return e=n.sent,t=e.uid,r=e.puzzleKey,n.next=7,S.a.awrap(this.loadQuestions(t,r));case 7:(o=n.sent)&&this.setQuestions(o);case 9:case"end":return n.stop()}}),null,this)}},{key:"loadSavedResult",value:function(){var e=this.playerStore.main.isPremium,t=this.settingStore.getPremiumValue("quiz","isTrackingStats"),r=this.settingStore.getSettingValue("version"),o=this.settingStore.getPremiumValue("quiz","reloadGivenAnswers"),n=this.settingStore.getPremiumValue("quiz","disableRetry");(o||n)&&(e&&t?this.loadSavedPuzzleFromStats(r):this.loadLocalPuzzle(r))}},{key:"loadSavedPuzzleFromStats",value:function(e){var t,r,o,n;return S.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,S.a.awrap(this.playerStore.getPlayerCredentials());case 2:return t=a.sent,r=t.puzzleKey,o=t.uid,a.next=7,S.a.awrap(this.playerStore.main.db.account.getSavedPuzzle(o,r));case 7:(n=a.sent)&&e==n.version&&this.loadSavedAnswers(n);case 9:case"end":return a.stop()}}),null,this)}},{key:"loadLocalPuzzle",value:function(e){var t,r;return S.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.playerStore.main.puzzleKey,o.next=3,S.a.awrap(this.playerStore.getSavedPuzzle(t));case 3:((r=o.sent)&&r.version==e||!e)&&this.loadSavedAnswers(r);case 5:case"end":return o.stop()}}),null,this)}},{key:"loadSavedAnswers",value:function(e){if(e){var t=e.answers;t&&t.length&&(this.answers=t,this.currentQuestionIdx=this.answers.length-1,t.length==this.questions.length?this.setPhase(fo.c.quiz.phases.DONE):(this.nextQuestion(),this.setPhase(fo.c.quiz.phases.PLAY)))}}},{key:"loadQuestions",value:function(e,t){return this.playerStore.main.db.getNode({type:"questions",uid:e,puzzleKey:t})}},{key:"start",value:function(){this.setPhase(fo.c.quiz.phases.PLAY),this.usesTimer&&this.timer.start(null,this.waitForAnswer),this.playerStore.setHasAddedPuzzlePlayed()}},{key:"handleAnswer",value:function(e){if(!this.isCheckable){var t=Object(cr.a)(this.answers);t.push(e),this.answers=t,this.isCheckable=!0,this.usesTimer&&this.timer.stop(),this.savePlayerStats()}}},{key:"savePlayerStats",value:function(){var e=this.settingStore.getPremiumValue("quiz","isTrackingStats"),t=this.settingStore.getSettingValue("version");this.playerStore.autoSavePuzzle({answers:Object(C.q)(this.answers)},t,e)}},{key:"retry",value:function(){this.answers=[],this.currentQuestionIdx=0,this.setPhase(fo.c.quiz.phases.START),this.isCheckable=!1,this.playerStore.stats.startTimer(!0)}},{key:"nextQuestion",value:function(){this.isCheckable=!1,this.isLastQuestion?(this.setPhase(fo.c.quiz.phases.DONE),this.usesTimer&&(this.timer.stop(),this.playerStore.stats.timer.stop())):(this.currentQuestionIdx++,this.usesTimer&&this.timer.start(null,this.waitForAnswer))}},{key:"waitForAnswer",value:function(e){e>=1e3*(this.settingStore.getSettingValue("timerInSeconds")||fo.c.quiz.DEFAULT_QUESTION_TIME_SECONDS)&&this.handleAnswer(null)}},{key:"setQuestions",value:function(e){this.questions=e}},{key:"setPhase",value:function(e){this.phase=e}},{key:"usesTimer",get:function(){return this.settingStore.settings&&this.settingStore.getSettingValue("showTimer")}},{key:"isCompleted",get:function(){var e=this.settingStore.getPremiumValue("quiz","correctPercentage");return this.correctPercentage>=e&&this.phase===fo.c.quiz.phases.DONE}},{key:"isLastQuestion",get:function(){return this.currentQuestionIdx==this.questions.length-1}},{key:"correctPercentage",get:function(){return this.totalCorrect/this.totalQuestions*100|0}},{key:"totalQuestions",get:function(){return this.questions.length}},{key:"totalCorrect",get:function(){var e=this;return this.answers.reduce((function(t,r,o){return r==e.questions[o].correctAnswer?t+1:t}),0)}},{key:"isCorrect",get:function(){return!(null==this.activeAnswer||!this.isCheckable)&&this.activeAnswer==this.activeQuestion.correctAnswer}},{key:"activeAnswer",get:function(){return this.questions.length&&this.activeQuestion?this.answers[this.currentQuestionIdx]:null}},{key:"activeQuestion",get:function(){return this.questions.length?this.questions[this.currentQuestionIdx]:null}}]),e}(),Ur=Object(k.a)(Rr.prototype,"questions",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),qr=Object(k.a)(Rr.prototype,"phase",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return fo.c.quiz.phases.START}}),Wr=Object(k.a)(Rr.prototype,"currentQuestionIdx",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Kr=Object(k.a)(Rr.prototype,"answers",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Qr=Object(k.a)(Rr.prototype,"isCheckable",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(k.a)(Rr.prototype,"loadQuiz",[C.d],Object.getOwnPropertyDescriptor(Rr.prototype,"loadQuiz"),Rr.prototype),Object(k.a)(Rr.prototype,"loadSavedResult",[Mr],Object.getOwnPropertyDescriptor(Rr.prototype,"loadSavedResult"),Rr.prototype),Object(k.a)(Rr.prototype,"loadQuestions",[C.d],Object.getOwnPropertyDescriptor(Rr.prototype,"loadQuestions"),Rr.prototype),Object(k.a)(Rr.prototype,"usesTimer",[C.f],Object.getOwnPropertyDescriptor(Rr.prototype,"usesTimer"),Rr.prototype),Object(k.a)(Rr.prototype,"isCompleted",[C.f],Object.getOwnPropertyDescriptor(Rr.prototype,"isCompleted"),Rr.prototype),Object(k.a)(Rr.prototype,"isLastQuestion",[C.f],Object.getOwnPropertyDescriptor(Rr.prototype,"isLastQuestion"),Rr.prototype),Object(k.a)(Rr.prototype,"correctPercentage",[C.f],Object.getOwnPropertyDescriptor(Rr.prototype,"correctPercentage"),Rr.prototype),Object(k.a)(Rr.prototype,"totalQuestions",[C.f],Object.getOwnPropertyDescriptor(Rr.prototype,"totalQuestions"),Rr.prototype),Object(k.a)(Rr.prototype,"totalCorrect",[C.f],Object.getOwnPropertyDescriptor(Rr.prototype,"totalCorrect"),Rr.prototype),Object(k.a)(Rr.prototype,"isCorrect",[C.f],Object.getOwnPropertyDescriptor(Rr.prototype,"isCorrect"),Rr.prototype),Object(k.a)(Rr.prototype,"activeAnswer",[C.f],Object.getOwnPropertyDescriptor(Rr.prototype,"activeAnswer"),Rr.prototype),Object(k.a)(Rr.prototype,"activeQuestion",[C.f],Object.getOwnPropertyDescriptor(Rr.prototype,"activeQuestion"),Rr.prototype),Object(k.a)(Rr.prototype,"start",[Nr],Object.getOwnPropertyDescriptor(Rr.prototype,"start"),Rr.prototype),Object(k.a)(Rr.prototype,"handleAnswer",[_r],Object.getOwnPropertyDescriptor(Rr.prototype,"handleAnswer"),Rr.prototype),Object(k.a)(Rr.prototype,"savePlayerStats",[C.d],Object.getOwnPropertyDescriptor(Rr.prototype,"savePlayerStats"),Rr.prototype),Object(k.a)(Rr.prototype,"retry",[Fr],Object.getOwnPropertyDescriptor(Rr.prototype,"retry"),Rr.prototype),Object(k.a)(Rr.prototype,"nextQuestion",[Er],Object.getOwnPropertyDescriptor(Rr.prototype,"nextQuestion"),Rr.prototype),Object(k.a)(Rr.prototype,"waitForAnswer",[Vr],Object.getOwnPropertyDescriptor(Rr.prototype,"waitForAnswer"),Rr.prototype),Object(k.a)(Rr.prototype,"setQuestions",[C.d],Object.getOwnPropertyDescriptor(Rr.prototype,"setQuestions"),Rr.prototype),Object(k.a)(Rr.prototype,"setPhase",[Lr],Object.getOwnPropertyDescriptor(Rr.prototype,"setPhase"),Rr.prototype),Rr),wo=r("b2Sw"),jo=r.n(wo),Po=r("kHGI"),So=r.n(Po),zo=r("zJgK"),ko=r.n(zo);function Co(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Do(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Co(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Co(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ao,xo,Io,To,Go,Mo,No,_o,Fo,Eo,Vo,Lo,Ro,Uo,qo={players:[],numPlayers:fo.c.quartets.DEFAULT_NUM_STARTING_PLAYERS,active:!1,hasStarted:!1,key:null,activeCardPick:null,turnUid:null,message:"",winnerUid:null},Wo={name:"",active:!1,uid:null},Ko=(Br=C.m.shallow,Hr=C.m.shallow,Zr=C.d.bound,Xr=C.d.bound,Yr=C.d.bound,Jr=C.d.bound,$r=C.d.bound,eo=C.d.bound,to=C.d.bound,ro=C.d.bound,oo=C.d.bound,no=C.d.bound,ao=C.d.bound,io=C.d.bound,so=function(){function e(t,r){Object(b.a)(this,e),Object(z.a)(this,"sets",co,this),Object(z.a)(this,"isLoading",po,this),Object(z.a)(this,"isWaiting",lo,this),Object(z.a)(this,"askingACard",uo,this),Object(z.a)(this,"activePlayer",yo,this),Object(z.a)(this,"game",ho,this),Object(z.a)(this,"timer",bo,this),Object(z.a)(this,"showLeaveGameModal",go,this),Object(z.a)(this,"winningPlayer",mo,this),this.playerStore=t,this.settingStore=r,this.timer=new x,this.TIMER_COUNTDOWN_LENGTH=3,this.loadFromDb()}return Object(g.a)(e,[{key:"setActiveGameListener",value:function(){this.findActiveGame()}},{key:"onWindowClose",value:function(){this.isFakeAdmin()&&this.game&&!this.game.hasStarted&&this.stopActivity()}},{key:"loadFromDb",value:function(){var e,t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.a.awrap(this.playerStore.getPuzzleCredentials());case 2:return e=n.sent,t=e.uid,r=e.puzzleKey,n.next=7,S.a.awrap(this.playerStore.main.db.getNode({type:"quartets",uid:t,puzzleKey:r}));case 7:o=n.sent,this.setSets(o),this.setIsLoading(!1);case 10:case"end":return n.stop()}}),null,this)}},{key:"setShowLeaveGameModal",value:function(e){this.showLeaveGameModal=e}},{key:"resetGame",value:function(){this.game=Do({},qo,{players:[]}),this.activePlayer=Do({},Wo),this.playerStore.main.db.quartets.deleteGameViaUrl(),this.isWaiting=!0,this.winningPlayer=null,this.showLeaveGameModal=!1}},{key:"broadcastCardPick",value:function(e){var t=this,r=ye()(this.game.players,(function(t){return e.playerUid==t.uid})),o=this.playerStore.main.translations,n=o.asks,a=o.for_the_card,i="normal"==this.settingStore.getPremiumValue("quartets","type")?"name":"learn",s="".concat(this.currentPlayer.name," ").concat(n," ").concat(r.name," ").concat(a,": ").concat(e.setName," - ").concat(e[i]," ");this.playerStore.main.db.quartets.updateData({activeCardPick:e,message:s}).then((function(){return t.setAskingACard(t.askingACard.playerUid,!1)}))}},{key:"calcNextTurnUid",value:function(){var e=this,t=jo()(this.game.players,(function(t){return t.uid==e.currentPlayer.uid})),r=jo()(this.game.players,(function(e,r){return e.cards&&e.cards.length&&r>t})),o=-1===r?jo()(this.game.players,(function(e,r){return e.cards&&e.cards.length&&r<t})):r;return o>-1?this.game.players[o].uid:this.currentPlayer.uid}},{key:"switchTurn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!(this.winner||this.game.winnerUid||this.winningPlayer)){var t=e?"".concat(this.currentPlayer.name," ").concat(this.playerStore.main.translations.has_no_more_cards):"".concat(this.currentPlayer.name," ").concat(this.playerStore.main.translations.guessed_wrong);this.playerStore.main.db.quartets.updateData({activeCardPick:null,message:t,turnUid:this.calcNextTurnUid()})}}},{key:"swapCards",value:function(){var e=this,t=jo()(this.game.players,(function(t){return t.uid==e.game.activeCardPick.playerUid})),r=jo()(this.game.players,(function(t){return t.uid==e.game.turnUid})),o=this.game.players[t],n=jo()(o.cards,(function(t){return t.highlight==e.game.activeCardPick.highlight&&t.setName==e.game.activeCardPick.setName})),a=o.cards.splice(n,1)[0];if(this.game.players[r].cards.push(a),this.checkQuartet(this.game.players[r],a.setName)){this.createQuartet(this.game.players[r],a.setName);var i=this.playerStore.main.translations,s=i.guessed_right,c=i.has_quartet;this.playerStore.main.db.quartets.updateData({players:Object(C.q)(this.game.players),activeCardPick:null,message:"".concat(this.currentPlayer.name," ").concat(s," ").concat(c,": ").concat(a.setName)})}else this.playerStore.main.db.quartets.updateData({players:Object(C.q)(this.game.players),activeCardPick:null,message:"".concat(this.currentPlayer.name," ").concat(this.playerStore.main.translations.guessed_right)})}},{key:"createQuartet",value:function(e,t){var r=e.cards.filter((function(e){return e.setName!==t}));e.cards=r,e.quartets||(e.quartets=[]),e.quartets.push(t)}},{key:"checkQuartet",value:function(e,t){return e.cards.filter((function(e){return e.setName===t})).length===fo.c.quartets.SET_SIZE}},{key:"updateQuartetSettings",value:function(e){return this.playerStore.main.db.quartets.updateData(e)}},{key:"findActiveGame",value:function(){var e,t,r,o,n,a;return S.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,S.a.awrap(this.playerStore.getPlayerCredentials());case 2:return e=i.sent,t=e.uid,r=e.puzzleKey,(o=Do({},this.activePlayer)).uid=t,i.next=9,S.a.awrap(this.playerStore.main.db.quartets.findActiveGame(r,t));case 9:(n=i.sent).found&&(o.active=!0,a=ye()(n.game.players,(function(e){return e.uid==t})),o.name=a.name,this.playerStore.main.db.quartets.setGameUrl(r,n.game.key),this.playerStore.main.db.quartets.listenToGame(this.updateGame.bind(this)),this.checkIfGameHasStarted(n)),this.activePlayer=o;case 12:case"end":return i.stop()}}),null,this)}},{key:"checkIfGameHasStarted",value:function(e){e.game.hasStarted&&e.game.active&&this.setIsWaiting(!1)}},{key:"getGame",value:function(e){var t,r;return S.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.playerStore.main.puzzleKey,o.next=3,S.a.awrap(this.playerStore.main.db.quartets.getGame(t,e));case 3:return r=o.sent,o.next=6,S.a.awrap(this.playerStore.main.db.quartets.setGameUrl(t,r.key));case 6:return o.next=8,S.a.awrap(this.playerStore.main.db.quartets.listenToGame(this.updateGame.bind(this)));case 8:case"end":return o.stop()}}),null,this)}},{key:"setActivePlayerSetting",value:function(e,t){var r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=Do({},this.activePlayer))[e]=t,this.activePlayer=r,this.activePlayer.uid){n.next=8;break}return n.next=6,S.a.awrap(this.playerStore.main.getUser());case 6:o=n.sent,this.activePlayer=Do({},this.activePlayer,{uid:o.uid});case 8:if("active"!=e||!0!==t){n.next=14;break}return n.next=11,S.a.awrap(this.getGame(this.activePlayer));case 11:this.activateGame(),n.next=15;break;case 14:"active"==e&&!1===t&&this.stopActivity(this.activePlayer);case 15:case"end":return n.stop()}}),null,this)}},{key:"stopActivity",value:function(){return S.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.awrap(this.playerStore.main.db.quartets.leaveGame(this.activePlayer.uid));case 2:this.deactivateGame(this.game),this.playerStore.main.db.quartets.stopListening(),this.resetGame();case 5:case"end":return e.stop()}}),null,this)}},{key:"leaveGame",value:function(){return S.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return this.playerStore.main.db.quartets.updateData({activeCardPick:null,message:"".concat(this.me.name," ").concat(this.playerStore.main.translations.has_left_game)}),e.next=3,S.a.awrap(this.playerStore.main.db.quartets.leaveGame(this.activePlayer.uid));case 3:this.playerStore.main.db.quartets.stopListening(),this.deactivateGame(this.game);case 5:case"end":return e.stop()}}),null,this)}},{key:"setAskingACard",value:function(e,t){this.askingACard={playerUid:e,isActive:t}}},{key:"checkRemainingCountdown",value:function(e){e/1e3>=this.TIMER_COUNTDOWN_LENGTH&&(this.timer.stop(),this.startGame())}},{key:"startCountdown",value:function(){this.timer.start(0,this.checkRemainingCountdown)}},{key:"generateDeck",value:function(){return this.sets.reduce((function(e,t){var r=ko()(),o=t.cards.map((function(e,o){var n=Do({},e);return n.setName=t.name,n.highlight=t.options[o].number,n.image=t.options[o].image,n.options=Object(C.q)(t.options),n.setUid=r,n.idx=o,n}));return e.concat.apply(e,Object(cr.a)(o))}),[])}},{key:"dealCards",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=Math.floor(Math.random()*e.length);this.game.players[r].cards||(this.game.players[r].cards=[]);var n=e.splice(o,1)[0];if(this.game.players[r].cards.push(n),e.length>0){var a=r==this.game.players.length-1?0:r+1;return this.dealCards(e,a)}return So()(this.sets,(function(e){So()(t.game.players,(function(r){t.checkQuartet(r,e.name)&&t.createQuartet(r,e.name)}))})),this.playerStore.main.db.quartets.updateData({players:Object(C.q)(this.game.players)})}},{key:"clearPreviousCards",value:function(){So()(this.game.players,(function(e){return e.cards=[]}))}},{key:"isFakeAdmin",value:function(){return!!(this.activePlayer&&this.game.players&&this.game.players.length)&&this.activePlayer.uid==this.game.players[0].uid}},{key:"startGame",value:function(){var e;return S.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.setIsWaiting(!1),this.playerStore.setHasAddedPuzzlePlayed(),this.isFakeAdmin()){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,S.a.awrap(this.playerStore.main.db.quartets.updateData({hasStarted:!0}));case 6:e=this.generateDeck(),this.clearPreviousCards(),this.dealCards(e),this.pickStartingPlayer();case 10:case"end":return t.stop()}}),null,this)}},{key:"pickStartingPlayer",value:function(){var e=Math.floor(Math.random()*this.game.players.length);this.playerStore.main.db.quartets.updateData({turnUid:this.game.players[e].uid})}},{key:"checkWinner",value:function(e){var t=e.players.reduce((function(e,t){return e+(t.quartets?t.quartets.length:0)}),0);if(t&&this.sets.length&&t===this.sets.length){var r=e.players.filter((function(e){return e.quartets})).sort((function(e,t){return t.quartets.length-e.quartets.length}))[0];this.winningPlayer=r,this.playerStore.main.db.quartets.updateData({winnerUid:r.uid,message:"".concat(r.name," ").concat(this.playerStore.main.translations.wins,"!")})}}},{key:"activateGame",value:function(){this.playerStore.main.db.quartets.updateData({active:!0})}},{key:"deactivateGame",value:function(){this.playerStore.main.db.quartets.updateData(null)}},{key:"checkIfTurnShouldBePassed",value:function(){if(this.winner)return!1;!this.currentPlayer||this.currentPlayer.cards&&this.currentPlayer.cards.length||this.switchTurn(!0)}},{key:"updateGame",value:function(e){if(!e)return this.stopActivity();e.players?e.players.length!==parseInt(e.numPlayers)||e.hasStarted||this.startCountdown():e.players=[],e.winnerUid?e.winnerUid&&e.active&&this.deactivateGame(e):this.checkWinner(e),this.game=e,e&&e.active&&e.hasStarted&&e.turnUid&&this.checkIfTurnShouldBePassed(e)}},{key:"addPlayer",value:function(e){this.players=[].concat(Object(cr.a)(this.players),[e])}},{key:"setIsLoading",value:function(e){this.isLoading=e}},{key:"setSets",value:function(e){this.sets=e}},{key:"setIsWaiting",value:function(e){this.isWaiting=e}},{key:"countdownRemaining",get:function(){return this.timer.timePassed?this.TIMER_COUNTDOWN_LENGTH-this.timer.timePassed/1e3|0:this.TIMER_COUNTDOWN_LENGTH}},{key:"deckSize",get:function(){return this.sets?this.sets.reduce((function(e,t){return e+t.cards.length}),0):0}},{key:"isCompleted",get:function(){return!!this.game&&(!!this.winner||!!this.winningPlayer)}},{key:"winner",get:function(){var e=this;return this.game.winnerUid?ye()(this.game.players,(function(t){return e.game.winnerUid==t.uid})):null}},{key:"me",get:function(){var e=this;return this.game&&this.game.players?ye()(this.game.players,(function(t){return e.activePlayer.uid==t.uid})):{name:"Unknown",uid:"xx",cards:[]}}},{key:"availablePicks",get:function(){var e=this;return this.game&&this.game.players?this.game.players.reduce((function(t,r){return r.uid!=e.me.uid&&r.cards&&t.push.apply(t,Object(cr.a)(r.cards)),t}),[]):[]}},{key:"currentPlayer",get:function(){var e=this;return this.game.players&&this.game.turnUid?ye()(this.game.players,(function(t){return e.game.turnUid==t.uid})):{name:this.playerStore.main.translations.game_not_started}}}]),e}(),co=Object(k.a)(so.prototype,"sets",[Br],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),po=Object(k.a)(so.prototype,"isLoading",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),lo=Object(k.a)(so.prototype,"isWaiting",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),uo=Object(k.a)(so.prototype,"askingACard",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{playerUid:null,isActive:!1}}}),yo=Object(k.a)(so.prototype,"activePlayer",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Do({},Wo)}}),ho=Object(k.a)(so.prototype,"game",[Hr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Do({},qo,{players:[]})}}),bo=Object(k.a)(so.prototype,"timer",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),go=Object(k.a)(so.prototype,"showLeaveGameModal",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),mo=Object(k.a)(so.prototype,"winningPlayer",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Object(k.a)(so.prototype,"setActiveGameListener",[Zr],Object.getOwnPropertyDescriptor(so.prototype,"setActiveGameListener"),so.prototype),Object(k.a)(so.prototype,"onWindowClose",[Xr],Object.getOwnPropertyDescriptor(so.prototype,"onWindowClose"),so.prototype),Object(k.a)(so.prototype,"loadFromDb",[Yr],Object.getOwnPropertyDescriptor(so.prototype,"loadFromDb"),so.prototype),Object(k.a)(so.prototype,"countdownRemaining",[C.f],Object.getOwnPropertyDescriptor(so.prototype,"countdownRemaining"),so.prototype),Object(k.a)(so.prototype,"deckSize",[C.f],Object.getOwnPropertyDescriptor(so.prototype,"deckSize"),so.prototype),Object(k.a)(so.prototype,"isCompleted",[C.f],Object.getOwnPropertyDescriptor(so.prototype,"isCompleted"),so.prototype),Object(k.a)(so.prototype,"winner",[C.f],Object.getOwnPropertyDescriptor(so.prototype,"winner"),so.prototype),Object(k.a)(so.prototype,"me",[C.f],Object.getOwnPropertyDescriptor(so.prototype,"me"),so.prototype),Object(k.a)(so.prototype,"availablePicks",[C.f],Object.getOwnPropertyDescriptor(so.prototype,"availablePicks"),so.prototype),Object(k.a)(so.prototype,"currentPlayer",[C.f],Object.getOwnPropertyDescriptor(so.prototype,"currentPlayer"),so.prototype),Object(k.a)(so.prototype,"setShowLeaveGameModal",[Jr],Object.getOwnPropertyDescriptor(so.prototype,"setShowLeaveGameModal"),so.prototype),Object(k.a)(so.prototype,"resetGame",[$r],Object.getOwnPropertyDescriptor(so.prototype,"resetGame"),so.prototype),Object(k.a)(so.prototype,"broadcastCardPick",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"broadcastCardPick"),so.prototype),Object(k.a)(so.prototype,"calcNextTurnUid",[eo],Object.getOwnPropertyDescriptor(so.prototype,"calcNextTurnUid"),so.prototype),Object(k.a)(so.prototype,"switchTurn",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"switchTurn"),so.prototype),Object(k.a)(so.prototype,"swapCards",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"swapCards"),so.prototype),Object(k.a)(so.prototype,"createQuartet",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"createQuartet"),so.prototype),Object(k.a)(so.prototype,"checkQuartet",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"checkQuartet"),so.prototype),Object(k.a)(so.prototype,"updateQuartetSettings",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"updateQuartetSettings"),so.prototype),Object(k.a)(so.prototype,"findActiveGame",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"findActiveGame"),so.prototype),Object(k.a)(so.prototype,"checkIfGameHasStarted",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"checkIfGameHasStarted"),so.prototype),Object(k.a)(so.prototype,"getGame",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"getGame"),so.prototype),Object(k.a)(so.prototype,"setActivePlayerSetting",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"setActivePlayerSetting"),so.prototype),Object(k.a)(so.prototype,"stopActivity",[to],Object.getOwnPropertyDescriptor(so.prototype,"stopActivity"),so.prototype),Object(k.a)(so.prototype,"leaveGame",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"leaveGame"),so.prototype),Object(k.a)(so.prototype,"setAskingACard",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"setAskingACard"),so.prototype),Object(k.a)(so.prototype,"checkRemainingCountdown",[ro],Object.getOwnPropertyDescriptor(so.prototype,"checkRemainingCountdown"),so.prototype),Object(k.a)(so.prototype,"startCountdown",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"startCountdown"),so.prototype),Object(k.a)(so.prototype,"generateDeck",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"generateDeck"),so.prototype),Object(k.a)(so.prototype,"dealCards",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"dealCards"),so.prototype),Object(k.a)(so.prototype,"clearPreviousCards",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"clearPreviousCards"),so.prototype),Object(k.a)(so.prototype,"isFakeAdmin",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"isFakeAdmin"),so.prototype),Object(k.a)(so.prototype,"startGame",[oo],Object.getOwnPropertyDescriptor(so.prototype,"startGame"),so.prototype),Object(k.a)(so.prototype,"pickStartingPlayer",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"pickStartingPlayer"),so.prototype),Object(k.a)(so.prototype,"checkWinner",[no],Object.getOwnPropertyDescriptor(so.prototype,"checkWinner"),so.prototype),Object(k.a)(so.prototype,"activateGame",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"activateGame"),so.prototype),Object(k.a)(so.prototype,"deactivateGame",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"deactivateGame"),so.prototype),Object(k.a)(so.prototype,"checkIfTurnShouldBePassed",[ao],Object.getOwnPropertyDescriptor(so.prototype,"checkIfTurnShouldBePassed"),so.prototype),Object(k.a)(so.prototype,"updateGame",[io],Object.getOwnPropertyDescriptor(so.prototype,"updateGame"),so.prototype),Object(k.a)(so.prototype,"addPlayer",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"addPlayer"),so.prototype),Object(k.a)(so.prototype,"setIsLoading",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"setIsLoading"),so.prototype),Object(k.a)(so.prototype,"setSets",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"setSets"),so.prototype),Object(k.a)(so.prototype,"setIsWaiting",[C.d],Object.getOwnPropertyDescriptor(so.prototype,"setIsWaiting"),so.prototype),so),Qo=r("lojg");function Bo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Ho(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Bo(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Zo,Xo,Yo,Jo,$o,en,tn,rn,on,nn,an,sn,cn,pn,ln,un,dn,yn,hn=(Ao=C.d.bound,xo=C.d.bound,Io=C.d.bound,To=C.d.bound,Go=C.d.bound,Mo=C.d.bound,No=C.d.bound,_o=C.d.bound,Fo=C.d.bound,Eo=C.d.bound,Vo=function(){function e(t,r,o){Object(b.a)(this,e),Object(z.a)(this,"sets",Lo,this),Object(z.a)(this,"game",Ro,this),Object(z.a)(this,"sizePerCard",Uo,this),this.playerStore=t,this.settingStore=r,this.gamingStore=o,this.loadFromDb(),this.activeAudio=null,this.timeoutId=null}return Object(g.a)(e,[{key:"loadFromDb",value:function(){var e,t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.a.awrap(this.playerStore.getPuzzleCredentials());case 2:return e=n.sent,t=e.uid,r=e.puzzleKey,n.next=7,S.a.awrap(this.playerStore.main.db.memory.getCards(t,r));case 7:o=n.sent,this.setSets(o);case 9:case"end":return n.stop()}}),null,this)}},{key:"checkCompleted",value:function(){var e=this,t=this.settingStore.getSettingValue("version"),r=this.settingStore.getPremiumValue("memory","isTrackingStats");Object(C.e)((function(){e.playerStore.autoSavePuzzle({isCompleted:e.isCompleted},t,r)}))}},{key:"convertSetsIntoPlayingCards",value:function(){var e=this.sets.reduce((function(e,t,r){var o="cardset_".concat(r),n=t.map((function(e){return Ho({},e,{id:o})}));return[].concat(Object(cr.a)(e),Object(cr.a)(n))}),[]),t=Object(Qo.a)(e);this.setPlayingCards(t)}},{key:"scaleCardstoField",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.game.playingCards,r=window,o=r.innerHeight,n=r.innerWidth,a=n<700||e?160:240,i=n<700||e?80:240,s=(o-a)*(n-i),c=t.length,p=s/c,l={width:960,height:720},u=!1,d=Ho({},l);!u;){var y=p/(d.width+20)>d.height+20;y?u=!0:(d.width/=1.1,d.height/=1.1)}this.sizePerCard=Ho({},d)}},{key:"unflip",value:function(e){var t=this,r=this.settingStore.getSettingValue("flipTime");this.timeoutId=setTimeout((function(){e.activeCardIdxs=[],t.setGame(e),t.updateGameSession(e),t.timeoutId=null}),1e3*r)}},{key:"cardsMatch",value:function(e,t){var r=this.game.playingCards[e],o=this.game.playingCards[t];return r.id==o.id}},{key:"addScore",value:function(e){var t=e.score?Ho({},e.score):{},r="player_".concat(e.turnIdx);t[r]=t[r]?t[r]+1:1,e.score=t}},{key:"addFoundMatch",value:function(e,t){var r=[].concat(Object(cr.a)(t.foundCardIdxs),Object(cr.a)(e));t.activeCardIdxs=[],t.foundCardIdxs=r,this.addScore(t),this.setGame(t),this.updateGameSession(t),clearTimeout(this.timeoutId),this.timeoutId=null}},{key:"hasTwoActiveCards",value:function(e){return 2==e.length}},{key:"isCardAlreadyActive",value:function(e){return this.game.activeCardIdxs.indexOf(e)>-1}},{key:"isCardAlreadySolved",value:function(e){return this.game.foundCardIdxs.indexOf(e)>-1}},{key:"isYourTurn",value:function(){if(!this.settingStore.getPremiumValue("memory","forceMultiplayer"))return!0;var e=this.gamingStore.getPlayerIndex();return this.game.turnIdx===e}},{key:"isInFlipMode",value:function(){return!!this.timeoutId}},{key:"flipCard",value:function(e){this.playerStore.setHasAddedPuzzlePlayed();var t=Ho({},this.game),r=Object(cr.a)(t.activeCardIdxs);if(this.isInFlipMode())return!1;if(!this.isYourTurn())return!1;if(this.isCardAlreadyActive(e))return!1;if(this.hasTwoActiveCards(r))return!1;if(this.isCardAlreadySolved(e))return!1;r.push(e),t.activeCardIdxs=r;var o=this.game.playingCards[e];this.setActiveAudio(o.audio),r.length>1&&(this.cardsMatch(r[0],e)?this.addFoundMatch([r[0],e],t):this.switchTurn(t),this.unflip(t)),this.setGame(t),this.updateGameSession(t)}},{key:"setActiveAudio",value:function(e){e?(this.activeAudio&&this.activeAudio.pause(),this.activeAudio=new Audio(Object(xe.a)(e)),this.activeAudio.play()):this.activeAudio&&(this.activeAudio.pause(),this.activeAudio=null)}},{key:"switchTurn",value:function(e){this.settingStore.getPremiumValue("memory","forceMultiplayer")&&(e.turnIdx=0===e.turnIdx?1:0)}},{key:"updateGameSession",value:function(e){this.settingStore.getPremiumValue("memory","forceMultiplayer")&&"play"==this.gamingStore.status&&this.gamingStore.updateGameSession(Ho({},e,{score:Object(C.q)(e.score)||null,foundCardIdxs:Object(C.q)(e.foundCardIdxs),playingCards:Object(C.q)(e.playingCards)}))}},{key:"updateWithGameSessionInput",value:function(e){e&&this.setGame(Ho({activeCardIdxs:[],foundCardIdxs:[]},e))}},{key:"reset",value:function(){var e=this,t=Ho({},this.game);t.activeCardIdxs=[],t.foundCardIdxs=[],this.setGame(t),clearTimeout(this.timeoutId),this.timeoutId=setTimeout((function(){var t=Object(Qo.a)(e.game.playingCards);e.setPlayingCards(t),e.timeoutId=null}),1e3)}},{key:"setSets",value:function(e){this.sets=e}},{key:"setPlayingCards",value:function(e){var t=Ho({},this.game);t.playingCards=e,this.settingStore.getPremiumValue("memory","forceMultiplayer")?this.gamingStore.updateGameSession(t):this.setGame(t),this.scaleCardstoField()}},{key:"createField",value:function(){this.convertSetsIntoPlayingCards()}},{key:"setGame",value:function(e){this.game=e,this.scaleCardstoField()}},{key:"isMultiplayer",get:function(){return this.settingStore.getPremiumValue("memory","forceMultiplayer")}},{key:"isCompleted",get:function(){return!(!this.game||!this.sets)&&this.game.foundCardIdxs.length===2*this.sets.length}},{key:"currentTurnName",get:function(){var e=this.gamingStore.game;if(!e||!e.players||!e.players.length)return"";var t=e.players[this.game.turnIdx];return t?t.name:""}}]),e}(),Lo=Object(k.a)(Vo.prototype,"sets",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ro=Object(k.a)(Vo.prototype,"game",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{turnIdx:Math.round(Math.random()),activeCardIdxs:[],foundCardIdxs:[],playingCards:[],scores:{}}}}),Uo=Object(k.a)(Vo.prototype,"sizePerCard",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{width:240,height:180}}}),Object(k.a)(Vo.prototype,"loadFromDb",[C.d],Object.getOwnPropertyDescriptor(Vo.prototype,"loadFromDb"),Vo.prototype),Object(k.a)(Vo.prototype,"isMultiplayer",[C.f],Object.getOwnPropertyDescriptor(Vo.prototype,"isMultiplayer"),Vo.prototype),Object(k.a)(Vo.prototype,"isCompleted",[C.f],Object.getOwnPropertyDescriptor(Vo.prototype,"isCompleted"),Vo.prototype),Object(k.a)(Vo.prototype,"currentTurnName",[C.f],Object.getOwnPropertyDescriptor(Vo.prototype,"currentTurnName"),Vo.prototype),Object(k.a)(Vo.prototype,"checkCompleted",[Ao],Object.getOwnPropertyDescriptor(Vo.prototype,"checkCompleted"),Vo.prototype),Object(k.a)(Vo.prototype,"convertSetsIntoPlayingCards",[C.d],Object.getOwnPropertyDescriptor(Vo.prototype,"convertSetsIntoPlayingCards"),Vo.prototype),Object(k.a)(Vo.prototype,"scaleCardstoField",[xo],Object.getOwnPropertyDescriptor(Vo.prototype,"scaleCardstoField"),Vo.prototype),Object(k.a)(Vo.prototype,"unflip",[Io],Object.getOwnPropertyDescriptor(Vo.prototype,"unflip"),Vo.prototype),Object(k.a)(Vo.prototype,"cardsMatch",[C.d],Object.getOwnPropertyDescriptor(Vo.prototype,"cardsMatch"),Vo.prototype),Object(k.a)(Vo.prototype,"addScore",[To],Object.getOwnPropertyDescriptor(Vo.prototype,"addScore"),Vo.prototype),Object(k.a)(Vo.prototype,"addFoundMatch",[C.d],Object.getOwnPropertyDescriptor(Vo.prototype,"addFoundMatch"),Vo.prototype),Object(k.a)(Vo.prototype,"flipCard",[Go],Object.getOwnPropertyDescriptor(Vo.prototype,"flipCard"),Vo.prototype),Object(k.a)(Vo.prototype,"setActiveAudio",[Mo],Object.getOwnPropertyDescriptor(Vo.prototype,"setActiveAudio"),Vo.prototype),Object(k.a)(Vo.prototype,"switchTurn",[No],Object.getOwnPropertyDescriptor(Vo.prototype,"switchTurn"),Vo.prototype),Object(k.a)(Vo.prototype,"updateGameSession",[_o],Object.getOwnPropertyDescriptor(Vo.prototype,"updateGameSession"),Vo.prototype),Object(k.a)(Vo.prototype,"updateWithGameSessionInput",[Fo],Object.getOwnPropertyDescriptor(Vo.prototype,"updateWithGameSessionInput"),Vo.prototype),Object(k.a)(Vo.prototype,"reset",[C.d],Object.getOwnPropertyDescriptor(Vo.prototype,"reset"),Vo.prototype),Object(k.a)(Vo.prototype,"setSets",[C.d],Object.getOwnPropertyDescriptor(Vo.prototype,"setSets"),Vo.prototype),Object(k.a)(Vo.prototype,"setPlayingCards",[C.d],Object.getOwnPropertyDescriptor(Vo.prototype,"setPlayingCards"),Vo.prototype),Object(k.a)(Vo.prototype,"createField",[Eo],Object.getOwnPropertyDescriptor(Vo.prototype,"createField"),Vo.prototype),Object(k.a)(Vo.prototype,"setGame",[C.d],Object.getOwnPropertyDescriptor(Vo.prototype,"setGame"),Vo.prototype),Vo),bn=(r("hhXQ"),r("841G")),gn=r.n(bn);function mn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function On(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mn(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var fn,vn,wn,jn,Pn,Sn,zn,kn,Cn,Dn,An,xn,In,Tn,Gn={name:"",active:!1,uid:null},Mn=(Zo=C.d.bound,Xo=C.d.bound,Yo=C.d.bound,Jo=C.d.bound,$o=C.d.bound,en=C.d.bound,tn=C.d.bound,rn=C.d.bound,on=C.d.bound,nn=C.d.bound,an=C.d.bound,sn=C.d.bound,cn=C.d.bound,pn=function(){function e(t){Object(b.a)(this,e),Object(z.a)(this,"game",ln,this),Object(z.a)(this,"player",un,this),Object(z.a)(this,"timer",dn,this),Object(z.a)(this,"status",yn,this),this.playerStore=t,this.puzzleStore=null,this.timer=new x,this.TIMER_COUNTDOWN_LENGTH=3}return Object(g.a)(e,[{key:"getPlayerIndex",value:function(){var e=this;return gn()(this.game.players,(function(t){return t.uid==e.player.uid}))}},{key:"checkRemainingCountdown",value:function(e){e/1e3>=this.TIMER_COUNTDOWN_LENGTH&&(this.timer.stop(),this.playerStore.setShowPlayer(!0),this.setStatus("play"))}},{key:"startCountdown",value:function(){this.timer.start(0,this.checkRemainingCountdown)}},{key:"isFakeAdmin",value:function(){return!!(this.player&&this.game&&this.game.players&&this.game.players.length)&&this.player.uid==this.game.players[0].uid}},{key:"startGame",value:function(){return S.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.awrap(this.playerStore.main.db.gaming.updateGameSessionAttribute(On({},this.credentials,{attribute:"hasStarted"}),!0));case 2:this.startCountdown(),this.isFakeAdmin()&&this.puzzleStore.createField();case 4:case"end":return e.stop()}}),null,this)}},{key:"loadActiveGameSession",value:function(){var e,t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.a.awrap(this.playerStore.getPlayerCredentials());case 2:return e=n.sent,t=e.uid,r=e.puzzleKey,n.next=7,S.a.awrap(this.playerStore.main.db.gaming.findActiveGame(t,r));case 7:(o=n.sent)&&this.subscribeToGame(o);case 9:case"end":return n.stop()}}),null,this)}},{key:"updateGameSession",value:function(e){if(this.game){var t=this.playerStore.main.puzzleKey,r=this.game.sessionId;this.playerStore.main.db.gaming.updateGameSession(t,r,e)}}},{key:"subscribeToGame",value:function(e){if(!this.game){var t=this.playerStore.main.puzzleKey;this.playerStore.main.db.gaming.subscribeToGame(t,e,this.updateGame)}}},{key:"unsubscribeFromGame",value:function(){var e=this.credentials,t=e.puzzleKey,r=e.sessionId;this.playerStore.main.db.gaming.unsubscribeFromGame(t,r)}},{key:"updateGame",value:function(e){this.game=e,this.loadPlayer(e),e&&e.hasStarted&&!this.timer.hasStarted?(this.playerStore.setShowPlayer(!0),this.setStatus("play")):e&&!e.hasStarted&&e.players&&2==e.players.length&&this.startGame(),"play"===this.status&&this.puzzleStore.updateWithGameSessionInput(e.data),e&&e.hasStarted&&e.players&&e.players.length<2&&this.leaveGame()}},{key:"setStatus",value:function(e){this.status=e}},{key:"loadPlayer",value:function(e){var t,r;return S.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(e.players&&!this.player.uid){o.next=2;break}return o.abrupt("return");case 2:return o.next=4,S.a.awrap(this.playerStore.main.getUser());case 4:t=o.sent,r=ye()(e.players,(function(e){return e.uid===t.uid})),this.setPlayer(r);case 7:case"end":return o.stop()}}),null,this)}},{key:"setPlayer",value:function(e){this.player=e,this.player.active&&!this.game?this.enterGame():!this.player.active&&this.game&&this.leaveGame()}},{key:"leaveGame",value:function(){var e,t,r;return S.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.credentials,t=e.puzzleKey,r=e.sessionId,this.unsubscribeFromGame(),this.deactivateGame(),o.next=5,S.a.awrap(this.playerStore.main.db.gaming.leaveGame(t,r,this.player));case 5:this.player=On({},Gn),this.playerStore.setShowPlayer(!1),this.game=null,this.setStatus("closed");case 9:case"end":return o.stop()}}),null,this)}},{key:"deactivateGame",value:function(){this.playerStore.main.db.gaming.updateGameSessionAttribute(On({},this.credentials,{attribute:"active"}),!1)}},{key:"enterGame",value:function(){var e,t,r,o,n;return S.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e=this.playerStore.main.puzzleKey,a.next=3,S.a.awrap(this.playerStore.main.db.gaming.findActiveGames(e));case 3:if(t=a.sent,!(r=t?Object.values(t).filter((function(e){return!e.hasStarted})):[]).length){a.next=11;break}o=r[0].sessionId,this.subscribeToGame(o),this.playerStore.main.db.gaming.joinGame(e,o,this.player),a.next=15;break;case 11:return a.next=13,S.a.awrap(this.playerStore.main.db.gaming.createGame(e,this.player));case 13:n=a.sent,this.subscribeToGame(n);case 15:case"end":return a.stop()}}),null,this)}},{key:"setPuzzleStore",value:function(e){this.puzzleStore=e}},{key:"credentials",get:function(){return{puzzleKey:this.playerStore.main.puzzleKey,sessionId:this.game?this.game.sessionId:null}}},{key:"countdownRemaining",get:function(){return this.timer.timePassed?this.TIMER_COUNTDOWN_LENGTH-this.timer.timePassed/1e3|0:this.TIMER_COUNTDOWN_LENGTH}}]),e}(),ln=Object(k.a)(pn.prototype,"game",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),un=Object(k.a)(pn.prototype,"player",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return On({},Gn)}}),dn=Object(k.a)(pn.prototype,"timer",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yn=Object(k.a)(pn.prototype,"status",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"loading"}}),Object(k.a)(pn.prototype,"credentials",[C.f],Object.getOwnPropertyDescriptor(pn.prototype,"credentials"),pn.prototype),Object(k.a)(pn.prototype,"countdownRemaining",[C.f],Object.getOwnPropertyDescriptor(pn.prototype,"countdownRemaining"),pn.prototype),Object(k.a)(pn.prototype,"getPlayerIndex",[Zo],Object.getOwnPropertyDescriptor(pn.prototype,"getPlayerIndex"),pn.prototype),Object(k.a)(pn.prototype,"checkRemainingCountdown",[Xo],Object.getOwnPropertyDescriptor(pn.prototype,"checkRemainingCountdown"),pn.prototype),Object(k.a)(pn.prototype,"startCountdown",[C.d],Object.getOwnPropertyDescriptor(pn.prototype,"startCountdown"),pn.prototype),Object(k.a)(pn.prototype,"isFakeAdmin",[C.d],Object.getOwnPropertyDescriptor(pn.prototype,"isFakeAdmin"),pn.prototype),Object(k.a)(pn.prototype,"startGame",[Yo],Object.getOwnPropertyDescriptor(pn.prototype,"startGame"),pn.prototype),Object(k.a)(pn.prototype,"loadActiveGameSession",[Jo],Object.getOwnPropertyDescriptor(pn.prototype,"loadActiveGameSession"),pn.prototype),Object(k.a)(pn.prototype,"updateGameSession",[$o],Object.getOwnPropertyDescriptor(pn.prototype,"updateGameSession"),pn.prototype),Object(k.a)(pn.prototype,"subscribeToGame",[en],Object.getOwnPropertyDescriptor(pn.prototype,"subscribeToGame"),pn.prototype),Object(k.a)(pn.prototype,"unsubscribeFromGame",[tn],Object.getOwnPropertyDescriptor(pn.prototype,"unsubscribeFromGame"),pn.prototype),Object(k.a)(pn.prototype,"updateGame",[rn],Object.getOwnPropertyDescriptor(pn.prototype,"updateGame"),pn.prototype),Object(k.a)(pn.prototype,"setStatus",[on],Object.getOwnPropertyDescriptor(pn.prototype,"setStatus"),pn.prototype),Object(k.a)(pn.prototype,"setPlayer",[nn],Object.getOwnPropertyDescriptor(pn.prototype,"setPlayer"),pn.prototype),Object(k.a)(pn.prototype,"leaveGame",[an],Object.getOwnPropertyDescriptor(pn.prototype,"leaveGame"),pn.prototype),Object(k.a)(pn.prototype,"deactivateGame",[C.d],Object.getOwnPropertyDescriptor(pn.prototype,"deactivateGame"),pn.prototype),Object(k.a)(pn.prototype,"enterGame",[sn],Object.getOwnPropertyDescriptor(pn.prototype,"enterGame"),pn.prototype),Object(k.a)(pn.prototype,"setPuzzleStore",[cn],Object.getOwnPropertyDescriptor(pn.prototype,"setPuzzleStore"),pn.prototype),pn);function Nn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function _n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Fn,En,Vn,Ln,Rn,Un,qn,Wn,Kn,Qn,Bn,Hn,Zn,Xn,Yn=(fn=C.m.shallow,vn=C.d.bound,wn=C.d.bound,jn=C.d.bound,Pn=C.d.bound,Sn=C.d.bound,zn=function(){function e(t,r){Object(b.a)(this,e),this.MAX_DIMENSION=750,this.MAX_EXAMPLE_DIMENSION=330,Object(z.a)(this,"imageObj",kn,this),Object(z.a)(this,"slides",Cn,this),Object(z.a)(this,"maxDimension",Dn,this),Object(z.a)(this,"maxExampleDimension",An,this),Object(z.a)(this,"isShuffled",xn,this),Object(z.a)(this,"totalShuffles",In,this),Object(z.a)(this,"timer",Tn,this),this.playerStore=t,this.settingStore=r}return Object(g.a)(e,[{key:"checkProgress",value:function(){var e=this;Object(C.e)((function(){return e.autoSaveStats(e.isCompleted)}))}},{key:"autoSaveStats",value:function(e){if(this.totalShuffles>0&&this.playerStore.setHasAddedPuzzlePlayed(),e){var t=this.settingStore.getSettingValue("version"),r=this.settingStore.getPremiumValue("slidingPuzzle","isTrackingStats");this.playerStore.autoSavePuzzle(this.stats,t,r),this.timer.stop(),this.playerStore.stats.timer.stop()}}},{key:"reset",value:function(){this.isShuffled=!1,this.shuffle(),this.timer.start()}},{key:"resize",value:function(){var e=this.getRowsColumns(),t=e.rows,r=e.columns;this.maxDimension=Math.min(.9*window.innerWidth,this.MAX_DIMENSION),this.maxExampleDimension=Math.min(.8*window.innerWidth,this.MAX_EXAMPLE_DIMENSION);var o=this.dimensions.width/r,n=this.dimensions.height/t;this.slides=this.slides.map((function(e){return _n({},e,{width:o,height:n})}))}},{key:"calcSwap",value:function(e){var t,r=ye()(this.slides,(function(e){return e.last}));switch(e){case 39:t=ye()(this.slides,(function(e){return e.x===r.x-1&&e.y===r.y}));break;case 37:t=ye()(this.slides,(function(e){return e.x===r.x+1&&e.y===r.y}));break;case 40:t=ye()(this.slides,(function(e){return e.x===r.x&&e.y===r.y-1}));break;case 38:t=ye()(this.slides,(function(e){return e.x===r.x&&e.y===r.y+1}))}t&&this.swap(t)}},{key:"swap",value:function(e){if(!this.isCompleted){var t=Object(cr.a)(this.slides),r=gn()(this.slides,(function(e){return e.last})),o=gn()(this.slides,(function(t){return t.pos==e.pos})),n=_n({},t[r]),a=_n({},t[o]);if(a.neighbours.some((function(e){return e.x==n.x&&e.y==n.y}))){var i=_n({},t[r],{x:a.x,y:a.y,neighbours:a.neighbours}),s=_n({},a,{x:n.x,y:n.y,neighbours:n.neighbours});t[r]=i,t[o]=s,this.slides=t,this.totalShuffles++}}}},{key:"pickRandomNeighbour",value:function(e){var t=e.neighbours.filter((function(e){return null!==e.x&&null!==e.y}));return t[Math.random()*t.length|0]}},{key:"loadImage",value:function(){var e=this,t=new Image,r=this.settingStore.getSettingValue("image");t.src=Object(xe.a)(r),t.onload=function(){e.imageObj=t,e.resize(),e.calcSlides(),e.shuffle(),e.timer.start()}}},{key:"shuffle",value:function(){for(var e=this,t=this.settingStore.getPremiumValue("slidingPuzzle","difficultyLevel"),r=ye()(fo.c.slidingPuzzle.DIFFICULTY_LEVELS,(function(e){return e.difficulty==t})),o=this.getRowsColumns(),n=o.rows*o.columns*r.multiplier,a=function(t){var r=ye()(e.slides,(function(e){return e.last})),o=e.pickRandomNeighbour(r),n=ye()(e.slides,(function(e){return e.x===o.x&&e.y===o.y}));e.swap(n)},i=0;i<n;i++)a();this.isShuffled=!0,this.totalShuffles=0}},{key:"getRowsColumns",value:function(){return{rows:this.settingStore.getSettingValue("rows"),columns:this.settingStore.getSettingValue("columns")}}},{key:"getNeighbours",value:function(e,t){var r=this.getRowsColumns(),o=r.rows;return[{x:e>0?e-1:null,y:t,name:"left"},{x:e<r.columns-1?e+1:null,y:t,name:"right"},{x:e,y:t>0?t-1:null,name:"top"},{x:e,y:t<o-1?t+1:null,name:"bottom"}]}},{key:"calcSlides",value:function(){for(var e=this.getRowsColumns(),t=e.rows,r=e.columns,o=this.dimensions.width/r,n=this.dimensions.height/t,a=[],i=1,s=0;s<t;s++)for(var c=0;c<r;c++){var p={x:c,y:s,originX:c,originY:s,width:o,height:n,pos:i,neighbours:this.getNeighbours(c,s)};a.push(p),i++}a[a.length-1]=_n({},a[a.length-1],{last:!0}),this.slides=a}},{key:"isCompleted",get:function(){return!(!this.isShuffled||!this.slides.length)&&this.slides.every((function(e){return e.x===e.originX&&e.y===e.originY}))}},{key:"dimensions",get:function(){if(!this.imageObj)return null;var e=Math.min(this.maxDimension/this.imageObj.width,this.maxDimension/this.imageObj.height);return{width:this.imageObj.width*e,height:this.imageObj.height*e}}},{key:"exampleImageDimensions",get:function(){if(!this.imageObj)return null;var e=Math.min(this.maxExampleDimension/this.imageObj.width,this.maxExampleDimension/this.imageObj.height);return{width:this.imageObj.width*e,height:this.imageObj.height*e}}},{key:"stats",get:function(){return{totalShuffles:this.totalShuffles,timePassed:this.timer.timePassed}}}]),e}(),kn=Object(k.a)(zn.prototype,"imageObj",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cn=Object(k.a)(zn.prototype,"slides",[fn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Dn=Object(k.a)(zn.prototype,"maxDimension",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.MAX_DIMENSION}}),An=Object(k.a)(zn.prototype,"maxExampleDimension",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.MAX_EXAMPLE_DIMENSION}}),xn=Object(k.a)(zn.prototype,"isShuffled",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),In=Object(k.a)(zn.prototype,"totalShuffles",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Tn=Object(k.a)(zn.prototype,"timer",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new x}}),Object(k.a)(zn.prototype,"checkProgress",[vn],Object.getOwnPropertyDescriptor(zn.prototype,"checkProgress"),zn.prototype),Object(k.a)(zn.prototype,"isCompleted",[C.f],Object.getOwnPropertyDescriptor(zn.prototype,"isCompleted"),zn.prototype),Object(k.a)(zn.prototype,"dimensions",[C.f],Object.getOwnPropertyDescriptor(zn.prototype,"dimensions"),zn.prototype),Object(k.a)(zn.prototype,"exampleImageDimensions",[C.f],Object.getOwnPropertyDescriptor(zn.prototype,"exampleImageDimensions"),zn.prototype),Object(k.a)(zn.prototype,"stats",[C.f],Object.getOwnPropertyDescriptor(zn.prototype,"stats"),zn.prototype),Object(k.a)(zn.prototype,"autoSaveStats",[wn],Object.getOwnPropertyDescriptor(zn.prototype,"autoSaveStats"),zn.prototype),Object(k.a)(zn.prototype,"reset",[jn],Object.getOwnPropertyDescriptor(zn.prototype,"reset"),zn.prototype),Object(k.a)(zn.prototype,"resize",[Pn],Object.getOwnPropertyDescriptor(zn.prototype,"resize"),zn.prototype),Object(k.a)(zn.prototype,"swap",[Sn],Object.getOwnPropertyDescriptor(zn.prototype,"swap"),zn.prototype),Object(k.a)(zn.prototype,"loadImage",[C.d],Object.getOwnPropertyDescriptor(zn.prototype,"loadImage"),zn.prototype),Object(k.a)(zn.prototype,"shuffle",[C.d],Object.getOwnPropertyDescriptor(zn.prototype,"shuffle"),zn.prototype),Object(k.a)(zn.prototype,"calcSlides",[C.d],Object.getOwnPropertyDescriptor(zn.prototype,"calcSlides"),zn.prototype),zn),Jn=(r("a1Th"),r("qPuC")),$n=r("g5Md");function ea(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}var ta,ra,oa,na,aa,ia,sa,ca,pa,la,ua,da,ya,ha=(Fn=C.d.bound,En=C.d.bound,Vn=C.d.bound,Ln=C.d.bound,Rn=C.d.bound,Un=C.d.bound,qn=C.d.bound,Wn=C.d.bound,Kn=C.d.bound,Qn=C.d.bound,Bn=function(){function e(t,r){Object(b.a)(this,e),Object(z.a)(this,"charTable",Hn,this),Object(z.a)(this,"editingMode",Zn,this),Object(z.a)(this,"sentence",Xn,this),this.playerStore=t,this.settingStore=r,this.createCharTable()}return Object(g.a)(e,[{key:"checkProgress",value:function(){var e=this;Object(C.e)((function(){e.isCompleted&&e.savePuzzle()}))}},{key:"loadSavedPuzzle",value:function(){var e=this.settingStore.getSettingValue("version"),t=this.settingStore.getPremiumValue("cryptogram","isTrackingStats"),r=this.playerStore.main.isPremium;this.settingStore.getPremiumValue("cryptogram","reloadGivenAnswers")&&(r&&t?this.loadSavedPuzzleFromStats(e):this.loadLocalPuzzle(e))}},{key:"loadSavedPuzzleFromStats",value:function(e){var t,r,o,n;return S.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,S.a.awrap(this.playerStore.getPlayerCredentials());case 2:return t=a.sent,r=t.puzzleKey,o=t.uid,a.next=7,S.a.awrap(this.playerStore.main.db.account.getSavedPuzzle(o,r));case 7:(n=a.sent)&&e==n.version&&this.loadSavedAnswers(n);case 9:case"end":return a.stop()}}),null,this)}},{key:"loadLocalPuzzle",value:function(e){var t,r;return S.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.playerStore.main.puzzleKey,o.next=3,S.a.awrap(this.playerStore.getSavedPuzzle(t));case 3:((r=o.sent)&&r.version==e||!e)&&this.loadSavedAnswers(r);case 5:case"end":return o.stop()}}),null,this)}},{key:"loadSavedAnswers",value:function(e){if(e){var t=e.sentence,r=e.charTable;t&&(this.sentence=t),r&&(this.charTable=r)}}},{key:"savePuzzle",value:function(){var e=this.settingStore.getSettingValue("version"),t=this.settingStore.getPremiumValue("cryptogram","isTrackingStats");this.playerStore.autoSavePuzzle({charTable:Object(C.q)(this.charTable),sentence:Object(C.q)(this.sentence),isCompleted:this.isCompleted},e,t)}},{key:"reset",value:function(){this.createCharTable(),this.setEncryptedSentence(),this.savePuzzle()}},{key:"isCharHelper",value:function(e){var t=this.settingStore.getSettingValue("sentence"),r=this.settingStore.getSettingValue("helpers"),o=this.settingStore.getSettingValue("extraLetters");return Object($n.a)(e,t,r,o)}},{key:"setEncryptedSentence",value:function(){var e=this,t=this.settingStore.getSettingValue("encrypted_sentence");this.sentence=t,this.sentence.forEach((function(t){e.isCharHelper(t.char)&&(e.handleCharInput(t.number,{target:{value:t.char}}),e.handleNumberInput(t.char,{target:{value:t.number}}))}))}},{key:"createCharTable",value:function(){var e=Object(Jn.a)().split("").map((function(e){return{char:e,number:""}}));this.charTable=e}},{key:"handleCharEditingMode",value:function(e){this.editingMode={char:e,number:null,index:null},this.playerStore.setHasAddedPuzzlePlayed()}},{key:"handleNumberEditingMode",value:function(e,t){this.editingMode={char:null,number:e,index:t},this.playerStore.setHasAddedPuzzlePlayed()}},{key:"findMatchingChar",value:function(e){return e.toString().match(/^[0-9]+$/)?ye()(this.charTable,(function(t){return t.number==e})):""}},{key:"findMatchingColumnByChar",value:function(e){return e.toLowerCase().match(/^[a-z]$/)?ye()(this.sentence,(function(t){return t.char.toLowerCase()==e.toLowerCase()})):""}},{key:"handleNumberInput",value:function(e,t){var r=this,o=Object(cr.a)(this.charTable),n=gn()(o,(function(t){return t.char==e})),a=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ea(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ea(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},o[n]);a.number=parseInt(t.target.value)||"",o[n]=a,this.charTable=o;var i=Object(cr.a)(this.sentence).map((function(e){if(!e.number)return e;var t=r.findMatchingChar(e.number);return{char:t?t.char:"",number:e.number}}));this.sentence=i}},{key:"handleCharInput",value:function(e,t){var r=this;if(!this.isCharHelper(t.target.value)||""===t.target.value){var o=Object(cr.a)(this.sentence).map((function(r){return r.number?{char:r.number==e?t.target.value:r.char,number:r.number}:r}));this.sentence=o;var n=Object(cr.a)(this.charTable).map((function(e){var t=r.findMatchingColumnByChar(e.char);return t?{char:e.char,number:t.number}:{char:e.char,number:""}}));this.charTable=n}}},{key:"isCompleted",get:function(){if(!this.sentence)return!1;var e=this.settingStore.getSettingValue("sentence",this.settingStore.settings),t=this.sentence.map((function(e){return e.char})).join("");return t&&t.length&&e&&e.length&&e.toLowerCase()===t.toLowerCase()}}]),e}(),Hn=Object(k.a)(Bn.prototype,"charTable",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zn=Object(k.a)(Bn.prototype,"editingMode",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{char:null,number:null}}}),Xn=Object(k.a)(Bn.prototype,"sentence",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(k.a)(Bn.prototype,"checkProgress",[Fn],Object.getOwnPropertyDescriptor(Bn.prototype,"checkProgress"),Bn.prototype),Object(k.a)(Bn.prototype,"isCompleted",[C.f],Object.getOwnPropertyDescriptor(Bn.prototype,"isCompleted"),Bn.prototype),Object(k.a)(Bn.prototype,"loadSavedPuzzle",[En],Object.getOwnPropertyDescriptor(Bn.prototype,"loadSavedPuzzle"),Bn.prototype),Object(k.a)(Bn.prototype,"loadSavedAnswers",[Vn],Object.getOwnPropertyDescriptor(Bn.prototype,"loadSavedAnswers"),Bn.prototype),Object(k.a)(Bn.prototype,"savePuzzle",[Ln],Object.getOwnPropertyDescriptor(Bn.prototype,"savePuzzle"),Bn.prototype),Object(k.a)(Bn.prototype,"reset",[Rn],Object.getOwnPropertyDescriptor(Bn.prototype,"reset"),Bn.prototype),Object(k.a)(Bn.prototype,"isCharHelper",[Un],Object.getOwnPropertyDescriptor(Bn.prototype,"isCharHelper"),Bn.prototype),Object(k.a)(Bn.prototype,"setEncryptedSentence",[C.d],Object.getOwnPropertyDescriptor(Bn.prototype,"setEncryptedSentence"),Bn.prototype),Object(k.a)(Bn.prototype,"createCharTable",[C.d],Object.getOwnPropertyDescriptor(Bn.prototype,"createCharTable"),Bn.prototype),Object(k.a)(Bn.prototype,"handleCharEditingMode",[qn],Object.getOwnPropertyDescriptor(Bn.prototype,"handleCharEditingMode"),Bn.prototype),Object(k.a)(Bn.prototype,"handleNumberEditingMode",[Wn],Object.getOwnPropertyDescriptor(Bn.prototype,"handleNumberEditingMode"),Bn.prototype),Object(k.a)(Bn.prototype,"findMatchingChar",[C.d],Object.getOwnPropertyDescriptor(Bn.prototype,"findMatchingChar"),Bn.prototype),Object(k.a)(Bn.prototype,"findMatchingColumnByChar",[C.d],Object.getOwnPropertyDescriptor(Bn.prototype,"findMatchingColumnByChar"),Bn.prototype),Object(k.a)(Bn.prototype,"handleNumberInput",[Kn],Object.getOwnPropertyDescriptor(Bn.prototype,"handleNumberInput"),Bn.prototype),Object(k.a)(Bn.prototype,"handleCharInput",[Qn],Object.getOwnPropertyDescriptor(Bn.prototype,"handleCharInput"),Bn.prototype),Bn);function ba(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function ga(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ba(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ba(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ma,Oa,fa,va,wa,ja,Pa,Sa,za,ka,Ca,Da,Aa,xa,Ia,Ta,Ga,Ma,Na,_a,Fa=(ta=C.d.bound,ra=C.d.bound,oa=C.d.bound,na=C.d.bound,aa=C.d.bound,ia=C.d.bound,sa=C.d.bound,ca=C.d.bound,pa=C.d.bound,la=C.d.bound,ua=function(){function e(t,r){Object(b.a)(this,e),Object(z.a)(this,"challenges",da,this),Object(z.a)(this,"timer",ya,this),this.playerStore=t,this.settingStore=r,this.loadFromDb(),this.errorTimeoutId=null,this.lockoutTimeoutId=null,this.currentWrongAnswers=0}return Object(g.a)(e,[{key:"checkKey",value:function(e,t){13==t.which&&this.checkCode(e)}},{key:"savePuzzlePlayed",value:function(){this.playerStore.setHasAddedPuzzlePlayed()}},{key:"loadFromDb",value:function(){var e,t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.a.awrap(this.playerStore.getPuzzleCredentials());case 2:return e=n.sent,t=e.uid,r=e.puzzleKey,n.next=7,S.a.awrap(this.playerStore.main.db.getNode({uid:t,puzzleKey:r,type:"scavenger_hunts"}));case 7:o=n.sent,this.challenges=o,this.unlockChallenge(0);case 10:case"end":return n.stop()}}),null,this)}},{key:"loadSavedPuzzle",value:function(){var e=this.settingStore.getSettingValue("version"),t=this.settingStore.getPremiumValue("scavenger-hunt","isTrackingStats"),r=this.playerStore.main.isPremium;this.settingStore.getPremiumValue("scavenger-hunt","reloadGivenAnswers")&&(r&&t?this.loadSavedPuzzleFromStats(e):this.loadLocalPuzzle(e))}},{key:"loadPreviousLockoutTime",value:function(){var e,t,r,o,n,a,i;return S.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,S.a.awrap(this.playerStore.getPlayerCredentials());case 2:return e=s.sent,t=e.puzzleKey,s.next=6,S.a.awrap(A.a.getItem("lockout_".concat(t)));case 6:(r=s.sent)&&(o=gn()(this.challenges,(function(e){return e.unlocked&&!e.completed})),n=this.settingStore.getPremiumValue("scavenger-hunt","lockoutDurationInSeconds"),a=(Date.now()-r)/1e3,i=n-a,this.lockoutChallenge(o,i));case 8:case"end":return s.stop()}}),null,this)}},{key:"loadSavedPuzzleFromStats",value:function(e){var t,r,o,n;return S.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,S.a.awrap(this.playerStore.getPlayerCredentials());case 2:return t=a.sent,r=t.puzzleKey,o=t.uid,a.next=7,S.a.awrap(this.playerStore.main.db.account.getSavedPuzzle(o,r));case 7:(n=a.sent)&&e&&e==n.version?this.loadSavedAnswers(n):this.loadPreviousLockoutTime();case 9:case"end":return a.stop()}}),null,this)}},{key:"loadLocalPuzzle",value:function(e){var t,r;return S.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.playerStore.main.puzzleKey,o.next=3,S.a.awrap(this.playerStore.getSavedPuzzle(t));case 3:(r=o.sent)&&r.version==e||!e?this.loadSavedAnswers(r):this.loadPreviousLockoutTime();case 5:case"end":return o.stop()}}),null,this)}},{key:"loadSavedAnswers",value:function(e){if(e){for(var t=e.progress,r=void 0===t?0:t,o=0;o<r;o++)this.completeChallenge(o,!1);r<this.challenges.length&&this.unlockChallenge(r),this.loadPreviousLockoutTime()}else this.loadPreviousLockoutTime()}},{key:"checkCode",value:function(e){this.challenges[e].code_input&&this.challenges[e].code&&this.challenges[e].code_input.toLowerCase()==this.challenges[e].code.toLowerCase()?(this.completeChallenge(e),this.challenges.length>e+1&&this.unlockChallenge(e+1)):this.errorChallenge(e)}},{key:"errorChallenge",value:function(e){var t=this,r=this.settingStore.getPremiumValue("scavenger-hunt","hasLockoutPeriod"),o=this.settingStore.getPremiumValue("scavenger-hunt","maxWrongAnswers"),n=this.settingStore.getPremiumValue("scavenger-hunt","lockoutDurationInSeconds");r&&this.currentWrongAnswers>=parseInt(o)&&this.lockoutChallenge(e,n);var a=Object(cr.a)(this.challenges);a[e]=ga({},a[e],{error:!0}),this.challenges=a,this.currentWrongAnswers++,clearTimeout(this.errorTimeoutId),this.errorTimeoutId=setTimeout((function(){var r=Object(cr.a)(t.challenges);r[e]=ga({},r[e],{error:!1}),t.challenges=r}),2500)}},{key:"lockoutChallenge",value:function(e,t){var r,o,n=this;return S.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return(r=Object(cr.a)(this.challenges))[e]=ga({},r[e],{lockout:!0}),this.challenges=r,o=this.playerStore.main.puzzleKey,a.next=6,S.a.awrap(A.a.getItem("lockout_".concat(o)));case 6:a.sent||A.a.setItem("lockout_".concat(o),Date.now()),this.timer.startCountdown(t,(function(){var t=Object(cr.a)(n.challenges);t[e]=ga({},t[e],{lockout:!1,error:!1}),n.challenges=t,n.currentWrongAnswers=0,A.a.removeItem("lockout_".concat(o))}));case 9:case"end":return a.stop()}}),null,this)}},{key:"completeChallenge",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=Object(cr.a)(this.challenges);r[e]=ga({},r[e],{completed:!0,unlocked:!0}),this.challenges=r,t&&this.saveProgress()}},{key:"reset",value:function(){this.challenges=this.challenges.map((function(e){return ga({},e,{completed:!1,unlocked:!1})})),this.unlockChallenge(0),this.playerStore.clearLocalPuzzle(),this.saveProgress()}},{key:"saveProgress",value:function(){var e=this.settingStore.getSettingValue("version"),t=this.settingStore.getPremiumValue("scavenger-hunt","isTrackingStats");this.playerStore.autoSavePuzzle({progress:this.challenges.filter((function(e){return e.completed})).length},e,t)}},{key:"unlockChallenge",value:function(e){if(this.challenges&&this.challenges.length){var t=Object(cr.a)(this.challenges);t[e]=ga({},t[e],{unlocked:!0}),this.challenges=t}}},{key:"handleCodeInput",value:function(e,t){var r=Object(cr.a)(this.challenges);r[e]=ga({},r[e],{code_input:t.target.value}),this.challenges=r}},{key:"isCompleted",get:function(){if(this.challenges.length)return this.challenges.every((function(e){return e.completed}))}}]),e}(),da=Object(k.a)(ua.prototype,"challenges",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ya=Object(k.a)(ua.prototype,"timer",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new x}}),Object(k.a)(ua.prototype,"isCompleted",[C.f],Object.getOwnPropertyDescriptor(ua.prototype,"isCompleted"),ua.prototype),Object(k.a)(ua.prototype,"checkKey",[ta],Object.getOwnPropertyDescriptor(ua.prototype,"checkKey"),ua.prototype),Object(k.a)(ua.prototype,"savePuzzlePlayed",[ra],Object.getOwnPropertyDescriptor(ua.prototype,"savePuzzlePlayed"),ua.prototype),Object(k.a)(ua.prototype,"loadFromDb",[C.d],Object.getOwnPropertyDescriptor(ua.prototype,"loadFromDb"),ua.prototype),Object(k.a)(ua.prototype,"checkCode",[oa],Object.getOwnPropertyDescriptor(ua.prototype,"checkCode"),ua.prototype),Object(k.a)(ua.prototype,"errorChallenge",[na],Object.getOwnPropertyDescriptor(ua.prototype,"errorChallenge"),ua.prototype),Object(k.a)(ua.prototype,"lockoutChallenge",[aa],Object.getOwnPropertyDescriptor(ua.prototype,"lockoutChallenge"),ua.prototype),Object(k.a)(ua.prototype,"completeChallenge",[ia],Object.getOwnPropertyDescriptor(ua.prototype,"completeChallenge"),ua.prototype),Object(k.a)(ua.prototype,"reset",[sa],Object.getOwnPropertyDescriptor(ua.prototype,"reset"),ua.prototype),Object(k.a)(ua.prototype,"saveProgress",[ca],Object.getOwnPropertyDescriptor(ua.prototype,"saveProgress"),ua.prototype),Object(k.a)(ua.prototype,"unlockChallenge",[pa],Object.getOwnPropertyDescriptor(ua.prototype,"unlockChallenge"),ua.prototype),Object(k.a)(ua.prototype,"handleCodeInput",[la],Object.getOwnPropertyDescriptor(ua.prototype,"handleCodeInput"),ua.prototype),ua),Ea=w.a.createElement;function Va(e){return e.show?Ea("div",{className:"jsx-973355614 Player2Ad"},Ea(Me.a.Google,{client:"ca-pub-8835136508126240",slot:"2045342550",style:{display:"block"},responsive:"true",format:"auto"}),Ea(Se.a,{id:"973355614"},[".Player2Ad.jsx-973355614{margin:20px 0;}","@media print{.Player2Ad.jsx-973355614{display:none;}}"])):null}function La(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Ra(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?La(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):La(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ua,qa,Wa,Ka,Qa,Ba,Ha,Za,Xa,Ya,Ja,$a,ei,ti,ri=(ma=C.m.shallow,Oa=C.d.bound,fa=C.d.bound,va=C.d.bound,wa=C.d.bound,ja=C.d.bound,Pa=C.d.bound,Sa=C.d.bound,za=C.d.bound,ka=C.d.bound,Ca=C.d.bound,Da=C.d.bound,Aa=C.d.bound,xa=C.d.bound,Ia=function(){function e(t,r){Object(b.a)(this,e),Object(z.a)(this,"field",Ta,this),Object(z.a)(this,"focus",Ga,this),Object(z.a)(this,"inputMap",Ma,this),Object(z.a)(this,"correctAnswersGiven",Na,this),Object(z.a)(this,"currentCell",_a,this),this.playerStore=t,this.settingStore=r}return Object(g.a)(e,[{key:"loadFromDb",value:function(){var e,t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.a.awrap(this.playerStore.getPuzzleCredentials());case 2:return e=n.sent,t=e.uid,r=e.puzzleKey,n.next=7,S.a.awrap(this.playerStore.main.db.getNode({type:"fields",uid:t,puzzleKey:r}));case 7:o=n.sent,this.setField(o),this.loadSavedPuzzle();case 10:case"end":return n.stop()}}),null,this)}},{key:"savePuzzle",value:function(){var e=this.settingStore.getSettingValue("version"),t=this.settingStore.getPremiumValue("acrostic","isTrackingStats"),r=this.calcCorrectPercentage();this.playerStore.autoSavePuzzle({inputMap:Object(C.q)(this.inputMap),correctPercentage:r,correctAnswersGiven:Object(C.q)(this.correctAnswersGiven)},e,t),this.playerStore.setHasAddedPuzzlePlayed()}},{key:"calcCorrectPercentage",value:function(){var e=this;return this.field.rows.reduce((function(t,r,o){var n=r.startX+r.index,a="".concat(o,"_").concat(n),i=e.inputMap[a]||"";return e.field.contestString[o]==i?t+1:t}),0)/this.field.contestString.length*100|0}},{key:"loadSavedPuzzle",value:function(){var e=this.settingStore.getSettingValue("version"),t=this.settingStore.getPremiumValue("acrostic","isTrackingStats"),r=this.playerStore.main.isPremium;this.settingStore.getPremiumValue("acrostic","reloadGivenAnswers")&&(r&&t?this.loadSavedPuzzleFromStats(e):this.loadLocalPuzzle(e))}},{key:"loadSavedPuzzleFromStats",value:function(e){var t,r,o,n;return S.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,S.a.awrap(this.playerStore.getPlayerCredentials());case 2:return t=a.sent,r=t.puzzleKey,o=t.uid,a.next=7,S.a.awrap(this.playerStore.main.db.account.getSavedPuzzle(o,r));case 7:(n=a.sent)&&e==n.version&&this.loadSavedAnswers(n);case 9:case"end":return a.stop()}}),null,this)}},{key:"loadLocalPuzzle",value:function(e){var t,r;return S.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.playerStore.main.puzzleKey,o.next=3,S.a.awrap(this.playerStore.getSavedPuzzle(t));case 3:((r=o.sent)&&r.version==e||!e)&&this.loadSavedAnswers(r);case 5:case"end":return o.stop()}}),null,this)}},{key:"loadSavedAnswers",value:function(e){if(e){var t=e.inputMap,r=e.correctAnswersGiven;t&&(this.setInputMap(t),this.correctAnswersGiven=r)}}},{key:"updateHelperCells",value:function(e,t){if(this.settingStore.getPremiumValue("acrostic","autofillSameHelpers")){var r=e.split("_"),o=Object(yr.a)(r,2),n=o[0],a=o[1],i=ye()(this.field.helpers,(function(e){return e.y==n&&e.x==a}));if(i){var s=this.field.helpers.filter((function(e){return i.number===e.number&&(i.x!=e.x||i.y!=e.y)})),c=Ra({},this.inputMap);s.forEach((function(e){var r="".concat(e.y,"_").concat(e.x);c[r]=t})),this.setInputMap(c)}}}},{key:"setInputMap",value:function(e){this.inputMap=e}},{key:"setCellValue",value:function(e,t){var r=Ra({},this.inputMap);r[e]=t,this.setInputMap(r),this.updateHelperCells(e,t),this.checkAnswer(),t&&this.setNextCell(e)}},{key:"checkAnswer",value:function(){var e=this;this.focus&&(this.focus.coords.reduce((function(t,r){var o=r.y,n=r.x,a="".concat(o,"_").concat(n);return t+(e.inputMap[a]||" ")}),"").toLowerCase()===this.focus.answer.toLowerCase()&&this.addCorrectAnswer(this.focus))}},{key:"addCorrectAnswer",value:function(e){var t=Object(cr.a)(this.correctAnswersGiven);if(!t.some((function(t){return t.uid==e.uid}))){var r=Ra({},e);delete r.overlap,delete r.score,t.push(r),this.correctAnswersGiven=t,this.savePuzzle()}}},{key:"setNextCell",value:function(e){var t=e.split("_"),r=Object(yr.a)(t,2),o=r[0],n=r[1],a="".concat(o,"_").concat(parseInt(n)+1);this.setCurrentCell(this.focus,a)}},{key:"setPrevCell",value:function(e){var t=e.split("_"),r=Object(yr.a)(t,2),o=r[0],n=r[1],a="".concat(o,"_").concat(parseInt(n)-1);this.setCurrentCell(this.focus,a)}},{key:"handleNavigation",value:function(e){var t=Ra({},this.currentCell);switch(e.key){case"ArrowRight":t.x++;break;case"ArrowLeft":t.x--;break;case"ArrowDown":case"Tab":t.y++;break;case"ArrowUp":t.y--}var r=this.field.rows[t.y];if(r){var o="".concat(t.y,"_").concat(t.x);this.setCurrentCell(r,o)}}},{key:"isCurrentCell",value:function(e,t){if(!t||!e)return!1;var r=e.split("_"),o=Object(yr.a)(r,2),n=o[0],a=o[1];return t.y==n&&t.x==a}},{key:"setCurrentCell",value:function(e,t){var r=t.split("_"),o=Object(yr.a)(r,2),n=o[0],a=o[1];if(console.log(e,t),e&&e.coords){var i=ye()(e.coords,(function(e){return e.y==n&&e.x==a}));i&&(this.setFocus(e),this.currentCell=i)}}},{key:"setFocus",value:function(e){this.focus=e}},{key:"setField",value:function(e){this.field=e}},{key:"reset",value:function(){this.setInputMap({}),this.setFocus(null),this.correctAnswersGiven=[],this.savePuzzle()}},{key:"isCompleted",get:function(){return!(!this.field||!this.field.rows)&&this.field.rows.filter((function(e){return e.index>-1&&e.answer})).length==this.correctAnswersGiven.length}}]),e}(),Ta=Object(k.a)(Ia.prototype,"field",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ga=Object(k.a)(Ia.prototype,"focus",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ma=Object(k.a)(Ia.prototype,"inputMap",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Na=Object(k.a)(Ia.prototype,"correctAnswersGiven",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_a=Object(k.a)(Ia.prototype,"currentCell",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(k.a)(Ia.prototype,"isCompleted",[C.f],Object.getOwnPropertyDescriptor(Ia.prototype,"isCompleted"),Ia.prototype),Object(k.a)(Ia.prototype,"savePuzzle",[Oa],Object.getOwnPropertyDescriptor(Ia.prototype,"savePuzzle"),Ia.prototype),Object(k.a)(Ia.prototype,"calcCorrectPercentage",[fa],Object.getOwnPropertyDescriptor(Ia.prototype,"calcCorrectPercentage"),Ia.prototype),Object(k.a)(Ia.prototype,"setInputMap",[va],Object.getOwnPropertyDescriptor(Ia.prototype,"setInputMap"),Ia.prototype),Object(k.a)(Ia.prototype,"setCellValue",[wa],Object.getOwnPropertyDescriptor(Ia.prototype,"setCellValue"),Ia.prototype),Object(k.a)(Ia.prototype,"checkAnswer",[ja],Object.getOwnPropertyDescriptor(Ia.prototype,"checkAnswer"),Ia.prototype),Object(k.a)(Ia.prototype,"addCorrectAnswer",[Pa],Object.getOwnPropertyDescriptor(Ia.prototype,"addCorrectAnswer"),Ia.prototype),Object(k.a)(Ia.prototype,"setNextCell",[Sa],Object.getOwnPropertyDescriptor(Ia.prototype,"setNextCell"),Ia.prototype),Object(k.a)(Ia.prototype,"setPrevCell",[za],Object.getOwnPropertyDescriptor(Ia.prototype,"setPrevCell"),Ia.prototype),Object(k.a)(Ia.prototype,"handleNavigation",[ka],Object.getOwnPropertyDescriptor(Ia.prototype,"handleNavigation"),Ia.prototype),Object(k.a)(Ia.prototype,"isCurrentCell",[Ca],Object.getOwnPropertyDescriptor(Ia.prototype,"isCurrentCell"),Ia.prototype),Object(k.a)(Ia.prototype,"setCurrentCell",[Da],Object.getOwnPropertyDescriptor(Ia.prototype,"setCurrentCell"),Ia.prototype),Object(k.a)(Ia.prototype,"setFocus",[Aa],Object.getOwnPropertyDescriptor(Ia.prototype,"setFocus"),Ia.prototype),Object(k.a)(Ia.prototype,"setField",[C.d],Object.getOwnPropertyDescriptor(Ia.prototype,"setField"),Ia.prototype),Object(k.a)(Ia.prototype,"reset",[xa],Object.getOwnPropertyDescriptor(Ia.prototype,"reset"),Ia.prototype),Ia);function oi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function ni(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oi(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ai,ii,si,ci,pi,li,ui,di,yi,hi,bi,gi,mi,Oi,fi,vi,wi,ji,Pi,Si,zi,ki,Ci,Di,Ai,xi,Ii,Ti,Gi,Mi,Ni,_i,Fi,Ei,Vi,Li,Ri,Ui,qi,Wi,Ki,Qi,Bi,Hi,Zi,Xi,Yi,Ji,$i,es,ts=(Ua=C.d.bound,qa=C.d.bound,Wa=C.d.bound,Ka=C.d.bound,Qa=C.d.bound,Ba=C.d.bound,Ha=C.d.bound,Za=function(){function e(t,r){Object(b.a)(this,e),Object(z.a)(this,"cards",Xa,this),Object(z.a)(this,"startSpots",Ya,this),Object(z.a)(this,"zones",Ja,this),Object(z.a)(this,"sets",$a,this),Object(z.a)(this,"activeCardUid",ei,this),Object(z.a)(this,"activeDropzone",ti,this),this.isCanceled=!1,this.playerStore=t,this.settingStore=r,this.loadFromDb()}return Object(g.a)(e,[{key:"loadFromDb",value:function(){var e,t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.a.awrap(this.playerStore.getPuzzleCredentials());case 2:return e=n.sent,t=e.uid,r=e.puzzleKey,n.next=7,S.a.awrap(this.playerStore.main.db.getNode({type:"matching_pairs",uid:t,puzzleKey:r}));case 7:o=n.sent,this.setSets(o),this.convertSetsIntoPlayingCards(),this.convertSetsIntoDropzones();case 11:case"end":return n.stop()}}),null,this)}},{key:"isMatch",value:function(e){return this.matches.some((function(t){var r=Object(yr.a)(t,1)[0];return e[0].uid==r.uid}))}},{key:"handleDrag",value:function(e){this.playerStore.setHasAddedPuzzlePlayed();var t=e.data.source.getAttribute("data-uid");this.setActiveCardUid(t)}},{key:"savePuzzle",value:function(){var e=this.settingStore.getSettingValue("version"),t=this.settingStore.getPremiumValue("matching-pairs","isTrackingStats");this.playerStore.autoSavePuzzle({answers:Object(C.q)(this.matches)},e,t)}},{key:"isCorrectColumn",value:function(e){return"random"==this.settingStore.getPremiumValue("matching-pairs","type")||e==this.activeCard.column}},{key:"handleDrop",value:function(e){this.isCanceled=!1;var t=e.data.dropzone.getAttribute("data-uid"),r=e.data.dropzone.getAttribute("data-column"),o=gn()(this.zones,(function(e){return e[0].uid===t||e[1].uid===t})),n=this.zones[o];if(e.data.dropzone.classList.contains("filled")||n&&this.isMatch(n)||!this.isCorrectColumn(r))return e.cancel(),void(this.isCanceled=!0);this.setActiveDropzone({uid:t,column:parseInt(r)})}},{key:"handleDragStop",value:function(){var e=this;if(!this.isCanceled){var t=gn()(this.cards,(function(t){return t&&t.uid===e.activeCardUid})),r=Object(cr.a)(this.cards),o=ni({},r[t],{dropzone:this.activeDropzone});r[t]=o,this.setCards(r),this.updateZone(),this.savePuzzle()}}},{key:"handleCancel",value:function(){this.isCanceled=!0}},{key:"clearOldZones",value:function(e){if(null!==e){var t=gn()(this.zones,(function(t){return t[0].cardUid===e||t[1].cardUid===e})),r=gn()(this.startSpots,(function(t){return t.cardUid==e}));if(r>-1){var o=Object(cr.a)(this.startSpots);o[r]=ni({},o[r],{cardUid:null}),this.setStartSpots(o)}if(-1!==t&&this.zones[t]){var n=Object(cr.a)(this.zones),a=Object(cr.a)(n[t]).map((function(t){return t.cardUid===e?ni({},t,{cardUid:null}):t}));n[t]=a,this.setZones(n)}}}},{key:"updateZone",value:function(){var e=this;this.clearOldZones(this.activeCardUid);var t=gn()(this.zones,(function(t){return e.activeDropzone&&t[e.activeDropzone.column]&&t[e.activeDropzone.column].uid===e.activeDropzone.uid})),r=Object(cr.a)(this.zones);if(r[t]){var o=Object(cr.a)(r[t]),n=ni({},o[this.activeDropzone.column],{cardUid:this.activeCardUid});o[this.activeDropzone.column]=n,r[t]=o,this.setZones(r)}}},{key:"convertSetsIntoPlayingCards",value:function(){var e=this.sets.reduce((function(e,t,r){var o="cardset_".concat(r),n=t.map((function(e,t){var r=ko()();return ni({},e,{set:o,column:t,uid:r,dropzone:null})}));return[].concat(Object(cr.a)(e),Object(cr.a)(n))}),[]),t=Object(Qo.a)(e),r=t.map((function(e){return{uid:ko()(),column:e.column,cardUid:e.uid}}));this.setStartSpots(r),this.setCards(t)}},{key:"convertSetsIntoDropzones",value:function(){var e=this.sets.map((function(e){var t=ko()();return[{uid:t,cardUid:null},{uid:t,cardUid:null}]})),t=Object(Qo.a)(e);this.setZones(t)}},{key:"setSets",value:function(e){this.sets=e}},{key:"setZones",value:function(e){this.zones=e}},{key:"setStartSpots",value:function(e){this.startSpots=e}},{key:"setCards",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.cards=e}},{key:"setActiveCardUid",value:function(e){this.activeCardUid=e}},{key:"setActiveDropzone",value:function(e){this.activeDropzone=e}},{key:"isCompleted",get:function(){return this.zones.length&&this.matches.length===this.zones.length}},{key:"activeCard",get:function(){var e=this;return this.activeCardUid?ye()(this.cards,(function(t){return t.uid==e.activeCardUid})):null}},{key:"matches",get:function(){var e=this;return this.zones.reduce((function(t,r){var o=Object(yr.a)(r,2),n=o[0],a=o[1],i=ye()(e.cards,(function(e){return e.uid===n.cardUid})),s=ye()(e.cards,(function(e){return e.uid===a.cardUid}));return i&&s?(i.set===s.set&&i.uid!=s.uid&&t.push([n,a]),t):t}),[])}}]),e}(),Xa=Object(k.a)(Za.prototype,"cards",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ya=Object(k.a)(Za.prototype,"startSpots",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ja=Object(k.a)(Za.prototype,"zones",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$a=Object(k.a)(Za.prototype,"sets",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ei=Object(k.a)(Za.prototype,"activeCardUid",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ti=Object(k.a)(Za.prototype,"activeDropzone",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{uid:null,column:null}}}),Object(k.a)(Za.prototype,"loadFromDb",[C.d],Object.getOwnPropertyDescriptor(Za.prototype,"loadFromDb"),Za.prototype),Object(k.a)(Za.prototype,"isCompleted",[C.f],Object.getOwnPropertyDescriptor(Za.prototype,"isCompleted"),Za.prototype),Object(k.a)(Za.prototype,"activeCard",[C.f],Object.getOwnPropertyDescriptor(Za.prototype,"activeCard"),Za.prototype),Object(k.a)(Za.prototype,"matches",[C.f],Object.getOwnPropertyDescriptor(Za.prototype,"matches"),Za.prototype),Object(k.a)(Za.prototype,"isMatch",[Ua],Object.getOwnPropertyDescriptor(Za.prototype,"isMatch"),Za.prototype),Object(k.a)(Za.prototype,"handleDrag",[qa],Object.getOwnPropertyDescriptor(Za.prototype,"handleDrag"),Za.prototype),Object(k.a)(Za.prototype,"savePuzzle",[Wa],Object.getOwnPropertyDescriptor(Za.prototype,"savePuzzle"),Za.prototype),Object(k.a)(Za.prototype,"handleDrop",[Ka],Object.getOwnPropertyDescriptor(Za.prototype,"handleDrop"),Za.prototype),Object(k.a)(Za.prototype,"handleDragStop",[Qa],Object.getOwnPropertyDescriptor(Za.prototype,"handleDragStop"),Za.prototype),Object(k.a)(Za.prototype,"handleCancel",[Ba],Object.getOwnPropertyDescriptor(Za.prototype,"handleCancel"),Za.prototype),Object(k.a)(Za.prototype,"clearOldZones",[Ha],Object.getOwnPropertyDescriptor(Za.prototype,"clearOldZones"),Za.prototype),Object(k.a)(Za.prototype,"updateZone",[C.d],Object.getOwnPropertyDescriptor(Za.prototype,"updateZone"),Za.prototype),Object(k.a)(Za.prototype,"convertSetsIntoPlayingCards",[C.d],Object.getOwnPropertyDescriptor(Za.prototype,"convertSetsIntoPlayingCards"),Za.prototype),Object(k.a)(Za.prototype,"convertSetsIntoDropzones",[C.d],Object.getOwnPropertyDescriptor(Za.prototype,"convertSetsIntoDropzones"),Za.prototype),Object(k.a)(Za.prototype,"setSets",[C.d],Object.getOwnPropertyDescriptor(Za.prototype,"setSets"),Za.prototype),Object(k.a)(Za.prototype,"setZones",[C.d],Object.getOwnPropertyDescriptor(Za.prototype,"setZones"),Za.prototype),Object(k.a)(Za.prototype,"setStartSpots",[C.d],Object.getOwnPropertyDescriptor(Za.prototype,"setStartSpots"),Za.prototype),Object(k.a)(Za.prototype,"setCards",[C.d],Object.getOwnPropertyDescriptor(Za.prototype,"setCards"),Za.prototype),Object(k.a)(Za.prototype,"setActiveCardUid",[C.d],Object.getOwnPropertyDescriptor(Za.prototype,"setActiveCardUid"),Za.prototype),Object(k.a)(Za.prototype,"setActiveDropzone",[C.d],Object.getOwnPropertyDescriptor(Za.prototype,"setActiveDropzone"),Za.prototype),Za),rs=r("OEhX"),os=(r("rE2o"),r("3XUZ")),ns=r("fW+M"),as=r("7Zaw");function is(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function ss(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?is(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):is(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var cs,ps,ls,us,ds,ys,hs,bs,gs,ms,Os,fs,vs,ws,js,Ps,Ss,zs,ks,Cs,Ds,As,xs,Is,Ts,Gs,Ms,Ns,_s,Fs,Es,Vs,Ls=(ai=C.m.shallow,ii=C.m.shallow,si=C.m.shallow,ci=C.m.shallow,pi=C.d.bound,li=C.d.bound,ui=C.d.bound,di=C.d.bound,yi=C.d.bound,hi=C.d.bound,bi=C.d.bound,gi=C.d.bound,mi=C.d.bound,Oi=C.d.bound,fi=C.d.bound,vi=C.d.bound,wi=C.d.bound,ji=C.d.bound,Pi=C.d.bound,Si=C.d.bound,zi=C.d.bound,ki=C.d.bound,Ci=C.d.bound,Di=C.d.bound,Ai=C.d.bound,xi=C.d.bound,Ii=C.d.bound,Ti=C.d.bound,Gi=C.d.bound,Mi=C.d.bound,Ni=C.d.bound,_i=C.d.bound,Fi=C.d.bound,Ei=C.d.bound,Vi=C.d.bound,Li=C.d.bound,Ri=C.d.bound,Ui=function(){function e(t,r){Object(b.a)(this,e),Object(z.a)(this,"rows",qi,this),Object(z.a)(this,"wordsPlaced",Wi,this),Object(z.a)(this,"correctAnswersGiven",Ki,this),Object(z.a)(this,"questions",Qi,this),Object(z.a)(this,"contest",Bi,this),Object(z.a)(this,"inputMap",Hi,this),Object(z.a)(this,"activeCell",Zi,this),Object(z.a)(this,"forceUpdate",Xi,this),Object(z.a)(this,"cellToUpdate",Yi,this),Object(z.a)(this,"orientation",Ji,this),Object(z.a)(this,"multiplayer",$i,this),Object(z.a)(this,"blockCellFocus",es,this),this.wordsPerCell={},this.playerStore=t,this.settingStore=r,this.loadFromDb()}return Object(g.a)(e,[{key:"loadFromDb",value:function(){var e,t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.a.awrap(this.playerStore.getPuzzleCredentials());case 2:return e=n.sent,t=e.uid,r=e.puzzleKey,n.next=7,S.a.awrap(this.playerStore.main.db.getNode({type:"fields",uid:t,puzzleKey:r}));case 7:if(o=n.sent){n.next=10;break}return n.abrupt("return");case 10:this.loadField(o);case 11:case"end":return n.stop()}}),null,this)}},{key:"loadQuestions",value:function(){var e,t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.a.awrap(this.playerStore.getPuzzleCredentials());case 2:return e=n.sent,t=e.uid,r=e.puzzleKey,n.next=7,S.a.awrap(this.playerStore.main.db.getNode({type:"questions",uid:t,puzzleKey:r}));case 7:o=n.sent,this.questions=o||[];case 9:case"end":return n.stop()}}),null,this)}},{key:"setContest",value:function(e){this.contest=e}},{key:"setMultiplayer",value:function(e){this.multiplayer=e}},{key:"loadField",value:function(e){var t=e.grid,r=e.offset,o=e.size,n=e.wordsPlaced,a=e.contest;this.rows=Object(os.c)(t,r,o),this.wordsPlaced=Object(os.d)(n,{offset:r,size:o}),this.contest={cells:Object(os.b)(a,{offset:r,size:o}),isAnagram:e.contestIsAnagram||!1,string:e.contestString||""},this.loadWordsPerCell()}},{key:"loadSavedPuzzle",value:function(){var e=this.settingStore.getSettingValue("version"),t=this.settingStore.getPremiumValue("crossword","playInTeams"),r=this.settingStore.getPremiumValue("crossword","isTrackingStats"),o=this.settingStore.getPremiumValue("crossword","reloadGivenAnswers");!t&&o&&(this.playerStore.main.isPremium&&r?this.loadSavedPuzzleFromStats(e):this.loadLocalPuzzle(e))}},{key:"loadSavedPuzzleFromStats",value:function(e){var t,r,o,n;return S.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,S.a.awrap(this.playerStore.getPlayerCredentials());case 2:return t=a.sent,r=t.puzzleKey,o=t.uid,a.next=7,S.a.awrap(this.playerStore.main.db.account.getSavedPuzzle(o,r));case 7:((n=a.sent)&&e==n.version||!e)&&this.loadSavedAnswers(n);case 9:case"end":return a.stop()}}),null,this)}},{key:"loadLocalPuzzle",value:function(e){var t,r;return S.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.playerStore.main.puzzleKey,o.next=3,S.a.awrap(this.playerStore.getSavedPuzzle(t));case 3:((r=o.sent)&&r.version==e||!e||r&&!r.version)&&this.loadSavedAnswers(r);case 5:case"end":return o.stop()}}),null,this)}},{key:"loadSavedAnswers",value:function(e){if(e){var t=e.inputMap,r=e.correctAnswersGiven;this.setInputMap(t,!0),r&&r.length&&this.setCorrectAnswersGiven(r),this.loadContest(),this.triggerForcedUpdate()}}},{key:"loadContest",value:function(){var e=this;Object.keys(this.inputMap).forEach((function(t){var r=t.split("_"),o=Object(yr.a)(r,2),n=o[0],a=o[1];e.updateContest(n,a,e.inputMap[t])}))}},{key:"handleInput",value:function(e,t,r,o){if(!this.blockCellFocus&&this.focus&&!this.isCompleted)if(o)r.target.value?this.goToNextCell(!0):this.goToPrevCell();else{var n=r.target.value;this.setCellValue(e,t,n),n&&this.goToNextCell(!0)}}},{key:"setBlockCellFocus",value:function(e){this.blockCellFocus=e}},{key:"setCellValue",value:function(e,t,r){var o=Object(os.e)(e,t),n=ss({},this.inputMap);n[o]=r.substring(0,1),this.inputMap=n,this.setUpdatedCell(e,t),this.checkForCorrectAnswers(o),this.settingStore.getPremiumValue("crossword","disableAnswerControl")&&this.updateContest(e,t,r)}},{key:"checkForCorrectAnswers",value:function(e){var t=this,r=this.wordsPerCell[e];r&&r.forEach((function(e){var r=t.buildAnswer(e);t.checkAnswer(r,e)&&t.handleCorrectAnswer(e)}))}},{key:"buildAnswer",value:function(e){var t=this,r=e.coords.map((function(e){var r=Object(yr.a)(e,2),o=r[0],n=r[1],a=Object(os.e)(o,n);return{row:o,column:n,value:t.inputMap[a]}}));return"horizontal"==focus.orientation&&r.sort((function(e,t){return e.column-t.column})),"vertical"==focus.orientation&&r.sort((function(e,t){return e.row-t.row})),r.reduce((function(e,t){return e+t.value}),"").toLowerCase()}},{key:"checkAnswer",value:function(e,t){return Object(as.default)(e)===t.answer}},{key:"handleCorrectAnswer",value:function(e){var t=this.settingStore.getPremiumValue("crossword","disableAnswerControl");this.isAnswerAlreadyGiven(e)||(this.addCorrectAnswer(e),this.savePuzzle(this.inputMap,this.correctAnswersGiven),this.playerStore.setHasAddedPuzzlePlayed(),this.handleTeamAnswer(this.inputMap),t||this.handleContestInput(e))}},{key:"isAnswerAlreadyGiven",value:function(e){return this.correctAnswersGiven.some((function(t){return e.uid?t.uid===e.uid:t.startX===e.startX&&t.startY===e.startY&&t.orientation===e.orientation}))}},{key:"addCorrectAnswer",value:function(e){var t=Object(cr.a)(this.correctAnswersGiven);return t.push(e),this.correctAnswersGiven=t,t}},{key:"savePuzzle",value:function(e,t){var r=this.settingStore.getSettingValue("version"),o=this.settingStore.getPremiumValue("crossword","isTrackingStats");this.playerStore.autoSavePuzzle({inputMap:e,correctAnswersGiven:Object(C.q)(t)},r,o)}},{key:"handleTeamAnswer",value:function(e){"play"===this.multiplayer.status&&this.updateTeamSession({inputMap:e,correctAnswersGiven:Object(C.q)(this.correctAnswersGiven)})}},{key:"updateTeamSession",value:function(e){this.multiplayer.updateTeamSession(e)}},{key:"updateWithTeamSessionInput",value:function(e){var t=e.inputMap,r=e.correctAnswersGiven,o=this.mergeAnswersWithNewAnswers(r);this.setCorrectAnswersGiven(o),this.setInputMap(t,!0),this.triggerForcedUpdate()}},{key:"mergeAnswersWithNewAnswers",value:function(e){return e?e.reduce((function(e,t){return e.some((function(e){return e.answer==t.answer}))?e:[].concat(Object(cr.a)(e),[t])}),Object(cr.a)(this.correctAnswersGiven)):this.correctAnswersGiven}},{key:"goToPrevCell",value:function(){var e=this.activeCell,t=e.row,r=e.column;"horizontal"===this.orientationName?this.setActiveCell(t,r-1,!0):"vertical"===this.orientationName&&this.setActiveCell(t-1,r,!0)}},{key:"goToNextCell",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.activeCell,r=t.row,o=t.column;"horizontal"===this.orientationName?this.setActiveCell(r,o+1,e):"vertical"===this.orientationName&&this.setActiveCell(r+1,o,e)}},{key:"getCellValue",value:function(e,t){var r=Object(os.e)(e,t);return this.inputMap[r]||""}},{key:"getStartNumber",value:function(e,t){var r=ye()(this.wordsPlaced,(function(r){return r.startY==e&&r.startX==t}));return r?r.position:null}},{key:"getContestNumber",value:function(e,t){var r=ye()(this.contest.cells,(function(r){return r.row==e&&r.column==t}));return r?r.number:null}},{key:"isWithinBounds",value:function(e,t){return e>=0&&t>=0&&this.rows.length&&e<this.rows.length&&t<this.rows[this.rows.length-1].length}},{key:"isBlank",value:function(e,t){var r=this.rows[e][t];return Object(os.a)(r)}},{key:"setActiveCell",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isWithinBounds(e,t)&&(this.isBlank(e,t)||(!r&&this.activeCell&&this.activeCell.row===e&&this.activeCell.column==t?this.orientation="horizontal"===this.orientation?"vertical":"horizontal":(this.activeCell={row:e,column:t},this.orientation=this.focus?this.focus.orientation:"horizontal")))}},{key:"handleNavigation",value:function(e,t){e.preventDefault(),this.handleArrowNavigation(e),this.handleOtherNavigation(e,t)}},{key:"handleOtherNavigation",value:function(e,t){if("Tab"===e.key)this.goToNextCell();else if("Backspace"===e.key){var r=this.activeCell,o=r.row,n=r.column;t||this.setCellValue(o,n,""),this.goToPrevCell()}}},{key:"handleArrowNavigation",value:function(e){var t=this.activeCell,r=t.row,o=t.column;switch(e.key){case"ArrowRight":o++;break;case"ArrowLeft":o--;break;case"ArrowDown":r++;break;case"ArrowUp":r--}ns.a.indexOf(e.which)>-1&&this.setActiveCell(r,o)}},{key:"loadWordsPerCell",value:function(){if(this.rows.length&&this.wordsPlaced.length){var e=this.wordsPlaced.reduce((function(e,t){return t.coords.forEach((function(r){var o=Object(yr.a)(r,2),n=o[0],a=o[1],i=Object(os.e)(n,a);e[i]?e[i].push(t):e[i]=[t]})),e}),{});this.wordsPerCell=e}}},{key:"setInputMap",value:function(e,t){var r=this;this.inputMap=ss({},this.inputMap,{},e),t&&Object.keys(this.inputMap).forEach((function(e){var t=e.split("_"),o=Object(yr.a)(t,2),n=o[0],a=o[1];r.setUpdatedCell(n,a)}))}},{key:"setCorrectAnswersGiven",value:function(e){this.correctAnswersGiven=e,this.setContestAnswers(e)}},{key:"setContestAnswers",value:function(e){var t=this;e.forEach((function(e){e.coords.forEach((function(e){var r=Object(yr.a)(e,2),o=r[0],n=r[1];t.updateContest(o,n)}))}))}},{key:"updateContest",value:function(e,t){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(this.contest){var n=gn()(this.contest.cells,(function(o){return r.contestCellIsMatching(o,e,t)}));this.settingStore&&this.settingStore.getPremiumValue("crossword","disableAnswerControl")&&n>-1?this.setContestCellValue(n,o):this.unlockContestCell(n),this.setUpdatedCell(e,t)}}},{key:"setUpdatedCell",value:function(e,t){this.cellToUpdate={row:e,column:t,timestamp:Date.now()}}},{key:"setContestCellValue",value:function(e,t){var r=ss({},this.contest),o=Object(cr.a)(r.cells),n=ss({},o[e]);o[e]=ss({},n,{value:t,unlocked:!0}),r.cells=o,this.setContest(r)}},{key:"contestCellIsMatching",value:function(e,t,r){return e.row==t&&e.column==r}},{key:"unlockContestCell",value:function(e){if(e>-1){var t=ss({},this.contest),r=Object(cr.a)(t.cells),o=ss({},r[e]);o.unlocked=!0,r[e]=o,t.cells=r,this.setContest(t)}}},{key:"handleContestInput",value:function(e){var t=!0,r=!1,o=void 0;try{for(var n,a=e.coords[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var i=n.value,s=i[0],c=i[1];this.updateContest(s,c)}}catch(p){r=!0,o=p}finally{try{t||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"reset",value:function(){this.resetFocus(),this.resetAnswers(),this.resetSavedPuzzle(),this.triggerForcedUpdate()}},{key:"resetSavedPuzzle",value:function(){this.playerStore.clearLocalPuzzle()}},{key:"resetAnswers",value:function(){var e=this;this.resetContest(),Object.keys(this.inputMap).forEach((function(t){var r=t.split("_"),o=Object(yr.a)(r,2),n=o[0],a=o[1];e.setCellValue(n,a,"")})),this.correctAnswersGiven=[]}},{key:"resetFocus",value:function(){this.activeCell=null}},{key:"resetContest",value:function(){var e=ss({},this.contest);e.cells=e.cells.map((function(e){return ss({},e,{unlocked:!1})})),this.setContest(e)}},{key:"triggerForcedUpdate",value:function(){this.forceUpdate=Date.now()}},{key:"handleSpecialCharacterInput",value:function(e){if(this.focus&&this.activeCell){var t=this.activeCell,r=t.row,o=t.column;this.setUpdatedCell(),this.currentCellIsReadOnly()||(this.setCellValue(r,o,e.key),this.goToNextCell())}}},{key:"currentCellIsReadOnly",value:function(){if(this.settingStore.getPremiumValue("crossword","disableAnswerControl"))return!1;var e=this.activeCell,t=e.row,r=e.column;return this.correctAnswersGiven.some((function(e){return e.coords.some((function(e){var o=Object(yr.a)(e,2),n=o[0],a=o[1];return n==t&&a==r}))}))}},{key:"insertAnswerFromBank",value:function(e){var t=this;e.split("").forEach((function(e){var r=t.activeCell,o=r.row,n=r.column;t.currentCellIsReadOnly()||t.setCellValue(o,n,e),t.goToNextCell(!0)})),this.triggerForcedUpdate()}},{key:"isCompleted",get:function(){return!!(this.correctAnswersGiven&&this.rows&&this.rows.length&&this.wordsPlaced&&this.wordsPlaced.length)&&this.correctAnswersGiven.length===this.wordsPlaced.length}},{key:"orientationName",get:function(){return this.focus?this.focus.orientation:null}},{key:"focus",get:function(){var e=this;if(!this.activeCell)return null;var t=this.activeCell,r=t.row,o=t.column,n=Object(os.e)(r,o),a=this.wordsPerCell[n];if(!a||!a.length)return null;var i=ye()(a,(function(t){return t.orientation==e.orientation}));return i||ye()(a,(function(t){return t.orientation!=e.orientation}))}}]),e}(),qi=Object(k.a)(Ui.prototype,"rows",[ai],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Wi=Object(k.a)(Ui.prototype,"wordsPlaced",[ii],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ki=Object(k.a)(Ui.prototype,"correctAnswersGiven",[si],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Qi=Object(k.a)(Ui.prototype,"questions",[ci],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Bi=Object(k.a)(Ui.prototype,"contest",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{cells:[],contestIsAnagram:!1,contestString:""}}}),Hi=Object(k.a)(Ui.prototype,"inputMap",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Zi=Object(k.a)(Ui.prototype,"activeCell",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xi=Object(k.a)(Ui.prototype,"forceUpdate",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Yi=Object(k.a)(Ui.prototype,"cellToUpdate",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ji=Object(k.a)(Ui.prototype,"orientation",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"horizontal"}}),$i=Object(k.a)(Ui.prototype,"multiplayer",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),es=Object(k.a)(Ui.prototype,"blockCellFocus",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(k.a)(Ui.prototype,"loadQuestions",[pi],Object.getOwnPropertyDescriptor(Ui.prototype,"loadQuestions"),Ui.prototype),Object(k.a)(Ui.prototype,"setContest",[C.d],Object.getOwnPropertyDescriptor(Ui.prototype,"setContest"),Ui.prototype),Object(k.a)(Ui.prototype,"setMultiplayer",[C.d],Object.getOwnPropertyDescriptor(Ui.prototype,"setMultiplayer"),Ui.prototype),Object(k.a)(Ui.prototype,"isCompleted",[C.f],Object.getOwnPropertyDescriptor(Ui.prototype,"isCompleted"),Ui.prototype),Object(k.a)(Ui.prototype,"orientationName",[C.f],Object.getOwnPropertyDescriptor(Ui.prototype,"orientationName"),Ui.prototype),Object(k.a)(Ui.prototype,"focus",[C.f],Object.getOwnPropertyDescriptor(Ui.prototype,"focus"),Ui.prototype),Object(k.a)(Ui.prototype,"loadField",[li],Object.getOwnPropertyDescriptor(Ui.prototype,"loadField"),Ui.prototype),Object(k.a)(Ui.prototype,"loadContest",[C.d],Object.getOwnPropertyDescriptor(Ui.prototype,"loadContest"),Ui.prototype),Object(k.a)(Ui.prototype,"handleInput",[ui],Object.getOwnPropertyDescriptor(Ui.prototype,"handleInput"),Ui.prototype),Object(k.a)(Ui.prototype,"setBlockCellFocus",[di],Object.getOwnPropertyDescriptor(Ui.prototype,"setBlockCellFocus"),Ui.prototype),Object(k.a)(Ui.prototype,"setCellValue",[yi],Object.getOwnPropertyDescriptor(Ui.prototype,"setCellValue"),Ui.prototype),Object(k.a)(Ui.prototype,"checkForCorrectAnswers",[hi],Object.getOwnPropertyDescriptor(Ui.prototype,"checkForCorrectAnswers"),Ui.prototype),Object(k.a)(Ui.prototype,"buildAnswer",[bi],Object.getOwnPropertyDescriptor(Ui.prototype,"buildAnswer"),Ui.prototype),Object(k.a)(Ui.prototype,"checkAnswer",[gi],Object.getOwnPropertyDescriptor(Ui.prototype,"checkAnswer"),Ui.prototype),Object(k.a)(Ui.prototype,"handleCorrectAnswer",[mi],Object.getOwnPropertyDescriptor(Ui.prototype,"handleCorrectAnswer"),Ui.prototype),Object(k.a)(Ui.prototype,"isAnswerAlreadyGiven",[Oi],Object.getOwnPropertyDescriptor(Ui.prototype,"isAnswerAlreadyGiven"),Ui.prototype),Object(k.a)(Ui.prototype,"addCorrectAnswer",[C.d],Object.getOwnPropertyDescriptor(Ui.prototype,"addCorrectAnswer"),Ui.prototype),Object(k.a)(Ui.prototype,"savePuzzle",[fi],Object.getOwnPropertyDescriptor(Ui.prototype,"savePuzzle"),Ui.prototype),Object(k.a)(Ui.prototype,"updateWithTeamSessionInput",[vi],Object.getOwnPropertyDescriptor(Ui.prototype,"updateWithTeamSessionInput"),Ui.prototype),Object(k.a)(Ui.prototype,"goToPrevCell",[wi],Object.getOwnPropertyDescriptor(Ui.prototype,"goToPrevCell"),Ui.prototype),Object(k.a)(Ui.prototype,"goToNextCell",[ji],Object.getOwnPropertyDescriptor(Ui.prototype,"goToNextCell"),Ui.prototype),Object(k.a)(Ui.prototype,"getCellValue",[Pi],Object.getOwnPropertyDescriptor(Ui.prototype,"getCellValue"),Ui.prototype),Object(k.a)(Ui.prototype,"getStartNumber",[Si],Object.getOwnPropertyDescriptor(Ui.prototype,"getStartNumber"),Ui.prototype),Object(k.a)(Ui.prototype,"getContestNumber",[zi],Object.getOwnPropertyDescriptor(Ui.prototype,"getContestNumber"),Ui.prototype),Object(k.a)(Ui.prototype,"isWithinBounds",[ki],Object.getOwnPropertyDescriptor(Ui.prototype,"isWithinBounds"),Ui.prototype),Object(k.a)(Ui.prototype,"isBlank",[Ci],Object.getOwnPropertyDescriptor(Ui.prototype,"isBlank"),Ui.prototype),Object(k.a)(Ui.prototype,"setActiveCell",[Di],Object.getOwnPropertyDescriptor(Ui.prototype,"setActiveCell"),Ui.prototype),Object(k.a)(Ui.prototype,"handleNavigation",[Ai],Object.getOwnPropertyDescriptor(Ui.prototype,"handleNavigation"),Ui.prototype),Object(k.a)(Ui.prototype,"handleOtherNavigation",[xi],Object.getOwnPropertyDescriptor(Ui.prototype,"handleOtherNavigation"),Ui.prototype),Object(k.a)(Ui.prototype,"handleArrowNavigation",[Ii],Object.getOwnPropertyDescriptor(Ui.prototype,"handleArrowNavigation"),Ui.prototype),Object(k.a)(Ui.prototype,"loadWordsPerCell",[Ti],Object.getOwnPropertyDescriptor(Ui.prototype,"loadWordsPerCell"),Ui.prototype),Object(k.a)(Ui.prototype,"setInputMap",[Gi],Object.getOwnPropertyDescriptor(Ui.prototype,"setInputMap"),Ui.prototype),Object(k.a)(Ui.prototype,"setCorrectAnswersGiven",[C.d],Object.getOwnPropertyDescriptor(Ui.prototype,"setCorrectAnswersGiven"),Ui.prototype),Object(k.a)(Ui.prototype,"setContestAnswers",[C.d],Object.getOwnPropertyDescriptor(Ui.prototype,"setContestAnswers"),Ui.prototype),Object(k.a)(Ui.prototype,"updateContest",[Mi],Object.getOwnPropertyDescriptor(Ui.prototype,"updateContest"),Ui.prototype),Object(k.a)(Ui.prototype,"setUpdatedCell",[Ni],Object.getOwnPropertyDescriptor(Ui.prototype,"setUpdatedCell"),Ui.prototype),Object(k.a)(Ui.prototype,"setContestCellValue",[C.d],Object.getOwnPropertyDescriptor(Ui.prototype,"setContestCellValue"),Ui.prototype),Object(k.a)(Ui.prototype,"contestCellIsMatching",[C.d],Object.getOwnPropertyDescriptor(Ui.prototype,"contestCellIsMatching"),Ui.prototype),Object(k.a)(Ui.prototype,"unlockContestCell",[C.d],Object.getOwnPropertyDescriptor(Ui.prototype,"unlockContestCell"),Ui.prototype),Object(k.a)(Ui.prototype,"reset",[_i],Object.getOwnPropertyDescriptor(Ui.prototype,"reset"),Ui.prototype),Object(k.a)(Ui.prototype,"resetSavedPuzzle",[C.d],Object.getOwnPropertyDescriptor(Ui.prototype,"resetSavedPuzzle"),Ui.prototype),Object(k.a)(Ui.prototype,"resetAnswers",[C.d],Object.getOwnPropertyDescriptor(Ui.prototype,"resetAnswers"),Ui.prototype),Object(k.a)(Ui.prototype,"resetFocus",[C.d],Object.getOwnPropertyDescriptor(Ui.prototype,"resetFocus"),Ui.prototype),Object(k.a)(Ui.prototype,"resetContest",[Fi],Object.getOwnPropertyDescriptor(Ui.prototype,"resetContest"),Ui.prototype),Object(k.a)(Ui.prototype,"triggerForcedUpdate",[Ei],Object.getOwnPropertyDescriptor(Ui.prototype,"triggerForcedUpdate"),Ui.prototype),Object(k.a)(Ui.prototype,"handleSpecialCharacterInput",[Vi],Object.getOwnPropertyDescriptor(Ui.prototype,"handleSpecialCharacterInput"),Ui.prototype),Object(k.a)(Ui.prototype,"currentCellIsReadOnly",[Li],Object.getOwnPropertyDescriptor(Ui.prototype,"currentCellIsReadOnly"),Ui.prototype),Object(k.a)(Ui.prototype,"insertAnswerFromBank",[Ri],Object.getOwnPropertyDescriptor(Ui.prototype,"insertAnswerFromBank"),Ui.prototype),Ui);function Rs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Us(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rs(Object(r),!0).forEach((function(t){Object(j.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rs(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var qs,Ws=(cs=C.m.shallow,ps=C.m.shallow,ls=C.m.shallow,us=C.m.shallow,ds=C.d.bound,ys=C.d.bound,hs=C.d.bound,bs=C.d.bound,gs=C.d.bound,ms=C.d.bound,Os=C.d.bound,fs=C.d.bound,vs=C.d.bound,ws=C.d.bound,js=C.d.bound,Ps=C.d.bound,Ss=C.d.bound,zs=C.d.bound,ks=C.d.bound,Cs=C.d.bound,Ds=C.d.bound,As=C.d.bound,xs=C.d.bound,Is=function(){function e(t,r){Object(b.a)(this,e),Object(z.a)(this,"grid",Ts,this),Object(z.a)(this,"wordsPlaced",Gs,this),Object(z.a)(this,"inputMap",Ms,this),Object(z.a)(this,"contest",Ns,this),Object(z.a)(this,"activeCell",_s,this),Object(z.a)(this,"cellToUpdate",Fs,this),Object(z.a)(this,"forceUpdate",Es,this),Object(z.a)(this,"correctAnswersGiven",Vs,this),this.playerStore=t,this.settingStore=r}return Object(g.a)(e,[{key:"loadFromDb",value:function(){var e,t,r,o;return S.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.a.awrap(this.playerStore.getPuzzleCredentials());case 2:return e=n.sent,t=e.uid,r=e.puzzleKey,n.next=7,S.a.awrap(this.playerStore.main.db.getNode({type:"fields",uid:t,puzzleKey:r}));case 7:o=n.sent,this.setField(o),this.loadSavedPuzzle(),this.loadHelpers();case 11:case"end":return n.stop()}}),null,this)}},{key:"loadHelpers",value:function(){var e=this,t=this.settingStore.getSettingValue("showFirstLetter"),r=this.settingStore.getSettingValue("showLastLetter");(t||r)&&(this.wordsPlaced.forEach((function(o){if(t){var n=Object(yr.a)(o.coords[0],2),a=n[0],i=n[1],s=e.getCellId(a,i),c=o.answer[0];e.setCellValue(s,c),e.updateContestCell(a,i,c)}if(r){var p=Object(yr.a)(o.coords[o.answer.length-1],2),l=p[0],u=p[1],d=e.getCellId(l,u),y=o.answer[o.answer.length-1];e.setCellValue(d,y),e.updateContestCell(l,u,y)}})),this.triggerForcedUpdate())}},{key:"loadSavedPuzzle",value:function(){var e=this.settingStore.getSettingValue("version"),t=this.settingStore.getPremiumValue("word-scramble","isTrackingStats"),r=this.playerStore.main.isPremium;this.settingStore.getPremiumValue("word-scramble","reloadGivenAnswers")&&(r&&t?this.loadSavedPuzzleFromStats(e):this.loadLocalPuzzle(e))}},{key:"loadSavedPuzzleFromStats",value:function(e){var t,r,o,n;return S.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,S.a.awrap(this.playerStore.getPlayerCredentials());case 2:return t=a.sent,r=t.puzzleKey,o=t.uid,a.next=7,S.a.awrap(this.playerStore.main.db.account.getSavedPuzzle(o,r));case 7:(n=a.sent)&&e==n.version&&this.loadSavedAnswers(n);case 9:case"end":return a.stop()}}),null,this)}},{key:"loadLocalPuzzle",value:function(e){var t,r;return S.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.playerStore.main.puzzleKey,o.next=3,S.a.awrap(this.playerStore.getSavedPuzzle(t));case 3:((r=o.sent)&&r.version==e||!e)&&this.loadSavedAnswers(r);case 5:case"end":return o.stop()}}),null,this)}},{key:"loadSavedAnswers",value:function(e){var t=this;if(e){var r=e.inputMap,o=e.correctAnswersGiven;if(r)this.setInputMap(r),this.correctAnswersGiven=o||[],this.settingStore.getPremiumValue("word-scramble","disableAnswerControl")?Object.keys(r).forEach((function(e){var o=e.split("_"),n=Object(yr.a)(o,2),a=n[0],i=n[1];t.updateContestCell(a,i,r[e])})):this.correctAnswersGiven.forEach((function(e){t.updateContest(e)})),this.triggerForcedUpdate()}}},{key:"getCellId",value:function(e,t){return"".concat(e,"_").concat(t)}},{key:"handleInput",value:function(e,t,r,o){if(r.preventDefault(),!o){var n=this.getCellId(e,t);this.setCellValue(n,r.target.value),this.setCellToUpdate(e,t),r.target.value&&this.goToNextCell()}}},{key:"getCellValue",value:function(e,t){var r=this.getCellId(e,t);return this.inputMap[r]}},{key:"setInputMap",value:function(e){this.inputMap=Us({},this.inputMap,{},e)}},{key:"setCellValue",value:function(e,t){var r=Us({},this.inputMap);r[e]=t.substring(0,1),this.setInputMap(r),this.checkAnswer(),this.settingStore.getPremiumValue("word-scramble","disableAnswerControl")&&this.updateContest(this.focus)}},{key:"setCellToUpdate",value:function(e,t){this.cellToUpdate={row:e,column:t,timestamp:Date.now()}}},{key:"checkAnswer",value:function(){var e=this;this.focus&&(this.focus.coords.reduce((function(t,r){var o=Object(yr.a)(r,2),n=o[0],a=o[1],i=e.getCellId(n,a);return t+(e.inputMap[i]||" ")}),"").toLowerCase()===this.focus.answer.toLowerCase()&&this.addCorrectAnswer(this.focus))}},{key:"addCorrectAnswer",value:function(e){var t=Object(cr.a)(this.correctAnswersGiven);if(!t.some((function(t){return t.uid==e.uid}))){var r=Us({},e);delete r.overlap,delete r.score,t.push(r),this.correctAnswersGiven=t,this.updateContest(this.focus),this.savePuzzle()}}},{key:"savePuzzle",value:function(){var e=this.settingStore.getSettingValue("version"),t=this.settingStore.getPremiumValue("word-scramble","isTrackingStats"),r=this.calcCorrectPercentage();this.playerStore.autoSavePuzzle({inputMap:Object(C.q)(this.inputMap),correctPercentage:r,correctAnswersGiven:Object(C.q)(this.correctAnswersGiven)},e,t),this.playerStore.setHasAddedPuzzlePlayed()}},{key:"calcCorrectPercentage",value:function(){return this.correctAnswersGiven.length/this.wordsPlaced.length*100}},{key:"goToNextCell",value:function(){var e=this.activeCell,t=e.row,r=e.column;this.setActiveCell(t,r+1)}},{key:"goToPrevCell",value:function(){var e=this.activeCell,t=e.row,r=e.column,o=this.getCellId(t,r);this.setActiveCell(t,r-1),this.setCellValue(o,"")}},{key:"handleNavigation",value:function(e){var t=Us({},this.activeCell);switch(e.key){case"ArrowRight":case"Tab":t.column++;break;case"ArrowLeft":t.column--;break;case"ArrowDown":t.row++;break;case"ArrowUp":t.row--}this.setActiveCell(t.row,t.column)}},{key:"isActiveCell",value:function(e,t){return this.activeCell.row==e&&this.activeCell.column==t}},{key:"cellIsOutOfBounds",value:function(e,t){return e<0||t<0||e>this.grid.length-1||t>this.grid[0].length-1}},{key:"cellIsBlank",value:function(e,t){return"@"==this.grid[e][t]}},{key:"setActiveCell",value:function(e,t){this.cellIsOutOfBounds(e,t)||this.cellIsBlank(e,t)||(this.activeCell={row:e,column:t},this.cellToUpdate=null)}},{key:"setField",value:function(e){this.grid=e.grid,this.wordsPlaced=e.wordsPlaced,this.contest=this.setupContest(e.contest)}},{key:"setupContest",value:function(e){if(!e)return null;var t=e.cells?e.cells.map((function(e){return Us({},e,{unlocked:!1})})):[];return Us({},e,{cells:t})}},{key:"updateContest",value:function(e){var t=this;if(this.contest&&e){var r=this.contest.cells.map((function(r){var o=ye()(e.coords,(function(e){var t=Object(yr.a)(e,2),o=t[0],n=t[1];return r.row==o&&r.column==n}));if(o){var n=t.getCellId(o[0],o[1]);return Us({},r,{unlocked:t.inputMap[n]||""})}return r}));this.contest=Us({},this.contest,{cells:r})}}},{key:"updateContestCell",value:function(e,t,r){if(this.contest){var o=this.contest.cells.map((function(o){return o.row==e&&o.column==t?Us({},o,{unlocked:r||""}):o}));this.contest=Us({},this.contest,{cells:o})}}},{key:"reset",value:function(){this.inputMap={},this.loadHelpers(),this.correctAnswersGiven=[],this.savePuzzle(),this.activeCell=null,this.cellToUpdate=null,this.contest&&(this.contest=Us({},this.contest,{cells:this.contest.cells.map((function(e){return Us({},e,{unlocked:""})}))})),this.triggerForcedUpdate()}},{key:"triggerForcedUpdate",value:function(){this.forceUpdate=Date.now()}},{key:"isCompleted",get:function(){return!!(this.grid&&this.grid.length&&this.correctAnswersGiven.length)&&this.correctAnswersGiven.length==this.wordsPlaced.length}},{key:"focus",get:function(){var e=this;return this.activeCell?ye()(this.wordsPlaced,(function(t){return t.coords.some((function(t){var r=Object(yr.a)(t,2),o=r[0],n=r[1];return e.activeCell.row==o&&e.activeCell.column==n}))})):null}}]),e}(),Ts=Object(k.a)(Is.prototype,"grid",[cs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Gs=Object(k.a)(Is.prototype,"wordsPlaced",[ps],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ms=Object(k.a)(Is.prototype,"inputMap",[ls],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Ns=Object(k.a)(Is.prototype,"contest",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_s=Object(k.a)(Is.prototype,"activeCell",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Fs=Object(k.a)(Is.prototype,"cellToUpdate",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Es=Object(k.a)(Is.prototype,"forceUpdate",[C.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Vs=Object(k.a)(Is.prototype,"correctAnswersGiven",[us],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(k.a)(Is.prototype,"isCompleted",[C.f],Object.getOwnPropertyDescriptor(Is.prototype,"isCompleted"),Is.prototype),Object(k.a)(Is.prototype,"focus",[C.f],Object.getOwnPropertyDescriptor(Is.prototype,"focus"),Is.prototype),Object(k.a)(Is.prototype,"handleInput",[ds],Object.getOwnPropertyDescriptor(Is.prototype,"handleInput"),Is.prototype),Object(k.a)(Is.prototype,"getCellValue",[ys],Object.getOwnPropertyDescriptor(Is.prototype,"getCellValue"),Is.prototype),Object(k.a)(Is.prototype,"setInputMap",[hs],Object.getOwnPropertyDescriptor(Is.prototype,"setInputMap"),Is.prototype),Object(k.a)(Is.prototype,"setCellValue",[bs],Object.getOwnPropertyDescriptor(Is.prototype,"setCellValue"),Is.prototype),Object(k.a)(Is.prototype,"setCellToUpdate",[gs],Object.getOwnPropertyDescriptor(Is.prototype,"setCellToUpdate"),Is.prototype),Object(k.a)(Is.prototype,"checkAnswer",[ms],Object.getOwnPropertyDescriptor(Is.prototype,"checkAnswer"),Is.prototype),Object(k.a)(Is.prototype,"addCorrectAnswer",[Os],Object.getOwnPropertyDescriptor(Is.prototype,"addCorrectAnswer"),Is.prototype),Object(k.a)(Is.prototype,"savePuzzle",[fs],Object.getOwnPropertyDescriptor(Is.prototype,"savePuzzle"),Is.prototype),Object(k.a)(Is.prototype,"calcCorrectPercentage",[vs],Object.getOwnPropertyDescriptor(Is.prototype,"calcCorrectPercentage"),Is.prototype),Object(k.a)(Is.prototype,"goToNextCell",[ws],Object.getOwnPropertyDescriptor(Is.prototype,"goToNextCell"),Is.prototype),Object(k.a)(Is.prototype,"goToPrevCell",[js],Object.getOwnPropertyDescriptor(Is.prototype,"goToPrevCell"),Is.prototype),Object(k.a)(Is.prototype,"handleNavigation",[Ps],Object.getOwnPropertyDescriptor(Is.prototype,"handleNavigation"),Is.prototype),Object(k.a)(Is.prototype,"isActiveCell",[Ss],Object.getOwnPropertyDescriptor(Is.prototype,"isActiveCell"),Is.prototype),Object(k.a)(Is.prototype,"setActiveCell",[zs],Object.getOwnPropertyDescriptor(Is.prototype,"setActiveCell"),Is.prototype),Object(k.a)(Is.prototype,"setField",[C.d],Object.getOwnPropertyDescriptor(Is.prototype,"setField"),Is.prototype),Object(k.a)(Is.prototype,"setupContest",[ks],Object.getOwnPropertyDescriptor(Is.prototype,"setupContest"),Is.prototype),Object(k.a)(Is.prototype,"updateContest",[Cs],Object.getOwnPropertyDescriptor(Is.prototype,"updateContest"),Is.prototype),Object(k.a)(Is.prototype,"updateContestCell",[Ds],Object.getOwnPropertyDescriptor(Is.prototype,"updateContestCell"),Is.prototype),Object(k.a)(Is.prototype,"reset",[As],Object.getOwnPropertyDescriptor(Is.prototype,"reset"),Is.prototype),Object(k.a)(Is.prototype,"triggerForcedUpdate",[xs],Object.getOwnPropertyDescriptor(Is.prototype,"triggerForcedUpdate"),Is.prototype),Is),Ks=w.a.createElement,Qs=Object(ve.b)("store")(qs=Object(ve.c)(qs=function(e){function t(e){var r;Object(b.a)(this,t),r=Object(m.a)(this,Object(O.a)(t).call(this,e));var o=e.store,n=e.PUZZLE_TYPE,a=e.isEmbedded,i=e.isReadOnly;return r.player=new ue(o,a,i),r.multiplayer=new dr(r.player),r.gaming=new Mn(r.player),r.setting=new me({player:r.player,multiplayer:r.multiplayer,gaming:r.gaming},Oe.a[n],fe.a[n]),r.puzzle=r.createPuzzleStore(n),r.multiplayer.setPuzzleStore(r.puzzle),r.gaming.setPuzzleStore(r.puzzle),r}return Object(f.a)(t,e),Object(g.a)(t,[{key:"createPuzzleStore",value:function(e){switch(e){case"CROSSWORD":return new Ls(this.player,this.setting);case"WORD_SEARCH":return new Oo(this.player,this.setting,this.multiplayer);case"QUIZ":return new vo(this.player,this.setting);case"QUARTETS":return new Ko(this.player,this.setting);case"MEMORY":return new hn(this.player,this.setting,this.gaming);case"SLIDING_PUZZLE":return new Yn(this.player,this.setting);case"CRYPTOGRAM":return new ha(this.player,this.setting);case"SCAVENGER_HUNT":return new Fa(this.player,this.setting);case"ACROSTIC":return new ri(this.player,this.setting);case"MATCHING_PAIRS":return new ts(this.player,this.setting);case"JIGSAW":return new rs.a(!0,this.player,this.setting);case"WORD_SCRAMBLE":return new Ws(this.player,this.setting)}}},{key:"render",value:function(){var e=this.props,t=e.isEmbedded,r=e.PUZZLE_TYPE,o=e.isLTI,n=e.store.isPremium,a=this.player,i=a.isLoading,s=a.showPlayer,c=this.puzzle.isCompleted,p=!1===n&&!o;return Ks(ve.a,{player:this.player,puzzle:this.puzzle,setting:this.setting,multiplayer:this.multiplayer,gaming:this.gaming},Ks(w.a.Fragment,null,s&&!i&&Ks(ot,{position:"top",isEmbedded:t,isLTI:o}),Ks(_e,{show:p}),this.props.children,Ks(Va,{show:p}),s&&!i&&Ks(ot,{position:"bottom",isEmbedded:t,isLTI:o}),!!c&&Ks(Te,null),!i&&Ks(Ct,null),("CROSSWORD"===r||"WORD_SEARCH"===r)&&Ks(sr,null),Ks(we.a,{isLoading:i})))}}]),t}(w.a.Component))||qs)||qs},LE2y:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return h}));var o=r("o0o1"),n=r.n(o),a=(r("VRzm"),r("rGqo"),r("yt8O"),r("Btvt"),r("XfO3"),r("ODXe")),i=(r("ls82"),r("1OyB")),s=r("vuIU"),c=r("md7G"),p=r("foSv"),l=r("Ji7U"),u=r("l/oI"),d=r("4J29"),y=r("TX29"),h=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,null,[{key:"getInitialProps",value:function(e){var t,r,o,i,s,c,p,l,u,h,b,g,m,O,f;return n.a.async((function(v){for(;;)switch(v.prev=v.next){case 0:return t=e.query,r=e.asPath,o=e.res,i=new d.a({language:t.language,path:r,query:t}),v.next=4,n.a.awrap(i.db.getIndex(t.p));case 4:if("string"===typeof(s=v.sent)){v.next=7;break}return v.abrupt("return",o.redirect(301,"/".concat(t.language,"/404")));case 7:return c=i.db.getPuzzleName(t.p),p=Object(y.c)(i),l=Object(y.e)(),u=i.db.getNode({type:"custom_styling",uid:s}),v.next=13,n.a.awrap(Promise.all([c,p,u,l]));case 13:return h=v.sent,b=Object(a.a)(h,4),g=b[0],m=b[1],O=b[2],f=b[3],v.abrupt("return",{language:t.language,path:r,query:t,puzzleName:g,customStylingUid:O?s:null,translations:m,urls:f});case 20:case"end":return v.stop()}}))}}]),t}(u.default)},Nhx4:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var o=r("D2ij"),n=[o.u,o.l,o.w,o.M],a=[o.u,o.l,o.w]},PFrS:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var o,n=r("o0o1"),a=r.n(n),i=(r("ls82"),r("1OyB")),s=r("vuIU"),c=r("md7G"),p=r("foSv"),l=r("JX7q"),u=r("Ji7U"),d=r("q1tI"),y=r.n(d),h=r("kMSe"),b=r("hfyT"),g=r("WJCh"),m=[r("D2ij").l],O=r("vOkV"),f=y.a.createElement,v=Object(h.b)("store")(o=Object(h.c)(o=function(e){function t(e){var r;return Object(i.a)(this,t),(r=Object(c.a)(this,Object(p.a)(t).call(this,e))).formStore=new g.a(m,r.handleSubmit.bind(Object(l.a)(r))),r}return Object(u.a)(t,e),Object(s.a)(t,[{key:"handleSubmit",value:function(e){var t=this;this.props.store.db.account.resetPassword(e.email).then((function(){return t.formStore.setIsDone(!0)})).catch((function(e){return t.formStore.setError(e)}))}},{key:"componentDidMount",value:function(){var e;return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(this.props.store.getUser());case 2:(e=t.sent)&&!e.isAnonymous&&this.formStore.setValue("email",this.props.store.user.email);case 4:case"end":return t.stop()}}),null,this)}},{key:"render",value:function(){var e=this.props.store,t=e.translations,r=e.user,o=this.formStore.isDone,n=r&&r.email?r.email:"";return f("div",{className:"ResetPasswordForm"},f(O.a,{form:this.formStore,header:"reset_password",immutable:{email:n}}),o?f(b.a,{text:t.email_was_sent}):null)}}]),t}(y.a.Component))||o)||o},Rak0:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var o=r("q1tI"),n=r.n(o),a=r("kMSe"),i=r("I0Ty"),s=r("NIHT"),c=n.a.createElement;function p(e){var t=e.store,r=e.children,o=e.meta,n=e.isEmbedded,p=e.hideFooterAd,l=e.isContentPage;return c(a.a,{store:t},c(i.a,{meta:o,isEmbedded:n,hideFooterAd:p,isContentPage:l},c(s.a,{isEmbedded:n},r)))}},"fW+M":function(e,t,r){"use strict";function o(e){return"Backspace"==e}function n(e){switch(e){case"ArrowRight":case"ArrowLeft":case"ArrowDown":case"ArrowUp":case"Tab":return!0;default:return!1}}r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return a}));var a=[37,39,38,40]},vyQL:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var o=r("D2ij"),n=[o.l,o.w]}}]);